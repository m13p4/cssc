/*
@version 1.0b
@author m13p4
@copyright Meliantchenkov Pavel
*/
var _debug=!0,csscDebug={},CSSC=function(){var r;_debug&&(csscDebug.ownElem=r);var v=function(m,v){var n={},w=!1,h=null;_debug&&(csscDebug.index=n);var y=function(){if(!w){if("cssRules"in m){var a=(m.ownerNode.getAttribute("data-cssc-ignore")||"").toLowerCase();if("true"!==a&&"1"!==a)try{x(m.cssRules,null)}catch(c){console.log('Cannot init CSS from "'+m.href+'"')}}else if("length"in m)for(var b=0;b<m.length;b++)if(a=(m[b].ownerNode.getAttribute("data-cssc-ignore")||"").toLowerCase(),"true"!==a&&"1"!==
a)try{x(m[b].cssRules,null)}catch(c){console.log('Cannot init CSS from "'+m[b].href+'"')}w=!0}},x=function(a,b){for(var c=0;c<a.length;c++)l.isElemInOwnNode(a[c])||B(a[c],b)},B=function(a,b){var c=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),e=a.type,d=b?b.children:n;if(e!==h.ruleType.rule&&e!==h.ruleType.fontFace&&e!==h.ruleType.media&&e!==h.ruleType.keyframes&&e!==h.ruleType.keyframe&&e!==h.ruleType.page&&e!==h.ruleType.supports)console.log("unsuported type: ["+e+"] - "+h.ruleType.names[e]);
else{a._update=!1;e===h.ruleType.rule&&(a.style._update={});b={indexElem:a,children:!1,parent:b?b:!1,events:{},type:e};d[c]?(d[c].content[0].indexElem===a&&(console.log('Dublicate "'+c+'": '),console.log(Error().stack+"\n\n")),b=d[c].content.push(b)-1):(d[c]={type:e,content:[b],events:{}},b=0);if(e===h.ruleType.media||e===h.ruleType.keyframes||e===h.ruleType.supports)d[c].content[b].children={},x(a.cssRules,d[c].content[b]);return d[c]}},t=function(a,b,c,e){e||r||l.createNewStyleElem();var d=e?e.indexElem:
r.sheet;var g=d.cssRules.length,k="";if(b){var f=l.elemType(b);if("Object"===f)for(var q in b)"Function"===l.elemType(b[q])?(c=b[q](),k+=q+":"+c+"; "):k+=q+":"+b[q]+"; ";else if("Function"===f)for(q in c=b(),c)k+=q+":"+c[q]+"; ";else k=b+":"+c+";"}try{return"insertRule"in d?d.insertRule(a+"{"+k+"}",g):"appendRule"in d?d.appendRule(a+"{"+k+"}",g):"addRule"in d&&d.addRule(a,k,g),B(d.cssRules[g],e)}catch(E){console.log('"'+a+'" -> '+E)}return!1},C=function(a,b){w||y();b=b?b:n;return b[a]?b[a]:null},
u=function(a,b,c){b=b?b:n;var e=l.elemType(a);if("String"===e)return b=C(a,b),c?b?b.content:[]:p(b?b.content:[],a);if("RegExp"===e){e=[];for(var d in b)if(d.match(a))for(g=0;g<b[d].content.length;g++)e.push(b[d].content[g]);return c?e:p(e,a)}if("Array"===e){e=[];var g;for(g=0;g<a.length;g++){var k=C(a[g],b);if(null!==k)for(d=0;d<k.content.length;d++)e.push(k.content[d])}return c?e:p(e,a)}if("Null"===e||"Undefined"===e){e=[];for(d in b)for(g=0;g<b[d].content.length;g++)e.push(b[d].content[g]);return c?
e:p(e,a)}return null},D=function(a,b,c,e){var d=l.elemType(a);if("String"===d||"RegExp"===d||"Array"===d||"Null"===d||"Undefined"===d)return a=u(a,c,e),b?a.has(b):a;z(a,null,c)},z=function(a,b){var c,e,d;for(e in a){var g="Array"===l.elemType(a[e])?a[e]:[a[e]];for(d=0;d<g.length;d++)if("@font-face"===e)t(e,g[d],null,b);else if(e.match(/^@(media|keyframes|supports)/)){if(c=t(e,null,null,b)){var k=c.content.length-1;z(g[d],c.content[k])}}else if(c=t(e,null,null,b))c=p(c.content,e),c.set(g[d])}},p=function(a,
b,c,e){var d=function(a,b){var f,g,e=[];for(f=0;f<d.e.length;f++)if(d.e[f].children){var c=D(a,b,d.e[f].children,!0);for(g=0;g<c.length;g++)e.push(c[g])}return p(e,a,null,d.e)};d.e=a;d.eLength=a.length;d.set=function(a,k,f){if("number"===typeof f){if(this.e[f].indexElem.type===h.ruleType.fontFace)return console.log('Element of Type "'+h.ruleType.names[this.e[f].indexElem.type]+'" is readonly.'),this;if(this.e[f].children)u(null,this.e[f].children).set(a,k);else if("Function"===l.elemType(k)){var g=
l.findPropInCssText(this.e[f].indexElem.cssText,a);g=k(g);this.e[f].indexElem.style[a]=l.parseValue(g);this.e[f].indexElem.style._update[a]=k}else this.e[f].indexElem.style[a]=l.parseValue(k)}else{var d,A,n=l.elemType(a);"Object"===n?g=Object.keys(a).length:"Function"===n&&(A=a());if(0>=this.e.length&&!c&&"String"===l.elemType(b)){var m,p=[];if(e)for(p=[],f=0;f<e.length;f++){if(m=t(b,null,null,e[f].indexElem,e[f].children))for(d=0;d<m.content.length;d++)p.push(m.content[d])}else if(m=t(b,null,null))p=
m.content;this.e=p;this.eLength=p.length}for(f=0;f<this.e.length;f++)if("Object"===n&&0<g)for(d in a)this.set(d,a[d],f);else if("Function"===n){for(d in A)this.set(d,A[d],f);this.e[f].indexElem._update=a}else this.set(a,k,f)}return this};d.get=function(a,b){var f=[],d="",e,c;b=!!b;for(c=0;c<this.e.length;c++)(e=this.e[c].indexElem.style[a])&&""!==e||(e=l.findPropInCssText(this.e[c].indexElem.cssText,a)),e&&(d=e,b&&f.push(d));return b?f:d};d.has=function(a){var e=[];var f=l.elemType(a);if("String"===
f){var c=a.split(":");for(f=0;f<this.e.length;f++){var d=l.findPropInCssText(this.e[f].indexElem.cssText,c[0]);""!==d&&(!c[1]||c[1]&&c[1].replace(/ |;/g,"")===d)&&e.push(this.e[f])}}else if("Array"===f)for(var g=0;g<a.length;g++)for(c=a[g].split(":"),f=0;f<this.e.length;f++)d=l.findPropInCssText(this.e[f].indexElem.cssText,c[0]),""!==d&&(!c[1]||c[1]&&c[1].replace(/ |;/g,"")===d)&&e.push(this.e[f]);else if("RegExp"===f)for(f=0;f<this.e.length;f++)if(c=this.e[f].indexElem.cssText.match(/[\S]+:.+?;/g))for(g=
0;g<c.length;g++)(d=c[g].match(a))&&e.push(this.e[f]);return p(e,b,!0)};d.update=function(){var a,b;for(a=0;a<this.e.length;a++){if(!1!==this.e[a].indexElem._update){var c=this.e[a].indexElem._update();for(b in c)this.set(b,c[b],a)}if(this.e[a].children)u(null,this.e[a].children).update();else for(b in this.e[a].indexElem.style._update)c=this.e[a].indexElem.style._update[b](),this.set(b,c,a)}return this};d.delete=function(a){var c;if("undefined"===typeof a)for(c=0;c<this.e.length;c++){this.e[c].indexElem.parentRule?
this.e[c].indexElem.parentRule.deleteRule(this.e[c]):this.e[c].indexElem.parentStyleSheet.deleteRule(this.e[c]);var d=this.e[c].parent?this.e[c].parent:null;d=d?d:n;d[b]&&delete d[b];this.e[c].children&&(d=u(null,this.e[c].children),d.delete(a))}else for(c=0;c<this.e.length;c++)this.e[c].indexElem.style[a]="",this.e[c].children&&(d=u(null,this.e[c].children),d.delete(a));return this};d.export=function(a){var c="",b;for(b=0;b<this.e.length;b++)c+=l.exportParser(this.e[b].indexElem.cssText,a);return c.trim()};
return d},l={elemType:function(a,b){return b?Object.prototype.toString.call(a):Object.prototype.toString.call(a).replace(/(^\[.+\s|\]$)/g,"")},createNewStyleElem:function(){if(document.getElementById(h.conf.styleId)){for(var a=0;10>a;a++)if(!document.getElementById(h.conf.styleId+"-"+a)){h.conf.styleId=h.conf.styleId+"-"+a;break}if(document.getElementById(h.conf.styleId))throw Error("cann not create new element..");}a=document.createElement("style");a.setAttribute("type","text/css");a.setAttribute("id",
h.conf.styleId);a.appendChild(document.createTextNode(""));document.head.appendChild(a);r=a;_debug&&(csscDebug.ownElem=r)},isElemInOwnNode:function(a){return a&&!!a.parentStyleSheet&&!!a.parentStyleSheet.ownerNode&&a.parentStyleSheet.ownerNode.id===h.conf.styleId},parseValue:function(a){if(isFinite(a))return 0===a%1?a+"px":Math.floor(100*a)/100+"px";var b=a.split(" ");if(0<b.length){for(var c=0;c<b.length;c++)isFinite(b[c])&&(a=b[c],b[c]=0===a%1?a+"px":Math.floor(100*a)/100+"px");return b.join(" ")}return a},
findPropInCssText:function(a,b){return(a=a.match(new RegExp(b+"s*:s*(.+?);")))?a[1].trim():""},exportParser:function(a,b){return b===h.export.type.ruleRow?a.replace(/\n/g,"")+"\n":b===h.export.type.min?a.replace(/(;|:|\s*?{|}|,)\s+/g,function(a){return a.trim()}):a.match(/^@(media|keyframes|supports)/)?a.replace(/^(.*){([\s\S]*)}$/,function(a,b,d){return b+"\n{\n    "+d.trim().replace(/({|}|;)\s*/g,function(a){a=a.trim();if("{"===a)return"\n    {\n        ";if("}"===a)return"}\n    ";if(";"===a)return";\n        "}).replace(/\s+}/g,
"\n    }").trim()+"\n}\n"}):a.replace(/({|}|;)\s*/g,function(a){a=a.trim();if("{"===a)return"\n"+a+"\n    ";if("}"===a)return a+"\n";if(";"===a)return a+"\n    "}).replace(/\s+}/,"\n}")}};h=function(a,b){return D(a,b)};h.import=function(a){return z(a)};h.export=function(a){var b="",c,e;for(c in n)for(e=0;e<n[c].content.length;e++)b+=l.exportParser(n[c].content[e].indexElem.cssText,a);return b.trim()};h.update=function(a){if(a)a=h(a),a.update();else for(var b in n)a=p(n[b].content),a.update()};h.ruleType=
{rule:1,charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,names:{1:"rule",2:"charset",3:"import",4:"media",5:"fontFace",6:"page",7:"keyframes",8:"keyframe",10:"namespace",11:"counterStyle",12:"supports",14:"fontFeatureValues"}};h.events={beforeChange:"beforechange",change:"change",beforeSet:"beforeset",set:"set",beforeCreate:"beforecreate",create:"create",beforeDelete:"beforedelete","delete":"delete",beforeDestroy:"beforedestroy",
destroy:"destroy"};h.export.type={normal:"normal",ruleRow:"ruleRow",min:"min"};h.conf={styleId:"cssc-style"};v?y():window.addEventListener("load",function(){y()});return h};_debug&&(csscDebug.cntrl=v);return v(document.styleSheets,!0)}();
