/* CSSC.js | @version 1.0b |  m13p4 */
var CSSC=function(){function w(b,a){a.view_err&&console.log(b);M.push(b)}function m(b,a,c){var d=Object.prototype.toString.call(b);if(c)return d;c=d.split(/ |\]/)[1];"Number"===c&&(c=Math.floor(b)===b?"integer":"float");return a?c.substr(0,a):c}function D(){if(Object.assign)return Object.assign.apply(null,arguments);var b,a;for(a=1;a<arguments.length;a++)for(b in arguments[a])arguments[0][b]=arguments[a][b];return arguments[0]}function N(b,a){var c;if(Object.defineProperty)for(c in a)Object.defineProperty(b,
c,{enumerable:!0,value:a[c]});else for(c in a)b[c]=a[c]}function G(b){if(Object.freeze)return Object.freeze(b);if(Object.defineProperty){var a={},c;for(c in b)Object.defineProperty(a,c,{enumerable:!0,value:b[c]});b=a}Object.preventExtensions&&Object.preventExtensions(b);return b}function x(b,a){if(!a&&Object.keys)return Object.keys(b);if(a&&Object.values)return Object.values(b);var c=[],d;for(d in b)c.push(a?b[d]:d);return c}function O(b,a,c){var d=m(b,1),e="S"===d,f=e&&b.match(/^0x[0-9a-f\.\+]+$/i);
if(isFinite(b)||f){c=(c||"px")+"";var g=b;f?(d=b.search(/\.|\+/),0>d?g=parseInt(b):(e=b.substr(d+1),g=parseInt(b.substr(0,d))+("+"===b.charAt(d)?parseFloat(e):parseInt(e,16)/Math.pow(16,e.length))),d=m(g,1)):e&&(g=parseFloat(b),d=m(g,1));f||a.match(/(^|-)color$/i)?(b=g,e=0,"f"===d&&(b=Math.floor(g),e=g-b),b=[(b&16711680)>>16,(b&65280)>>8,b&255].join(", "),b=0<e?"rgba("+b+", "+Math.floor(100*e)/100+")":"rgb("+b+")"):b="i"===d?g+c:Math.floor(100*g)/100+c}else if(e&&-1<b.indexOf(" ")){b=b.split(" ");
for(d=0;d<b.length;d++)b[d]=O(b[d],a,c);b=b.join(" ")}return b}function P(b){if(/^@(namespace|import|charset)/.test(b))return b.replace(/(^@(namespace|import|charset)\s*|\s*;\s*$)/g,"");var a=b.replace(/(^.*?{\s*|\s*}\s*$)/g,"");b=a.split(";");var c={};if(""!==a)for(a=0;a<b.length;a++)if(""!==b[a]){var d=b[a].split(":");c[d[0].trim()]=d.slice(1).join(":").trim()}return c}function z(b,a,c,d,e){var f=Array((parseInt(c)||2)+1).join(" "),g="",h,l=m(b,1);d=d||"";if("S"===l)return b;if("A"===l)for(l=0;l<
b.length;l++)g+=z(b[l],a,c,d,!0);else for(h in b){var k=""+b[h];l=m(b[h],1);if(/O|A/.test(l))if(e&&"A"===l){var n=z(b[h],a,c,d+f,e);""!==n&&(g=a?g+(h.replace(/\s*(,|:)\s*/g,"$1")+"{"+n+"}"):g+(d+h.replace(/\s*,\s*/g,",\n"+d)+" {\n"+n+d+"}\n"))}else for("O"===l&&(k=[b[h]]),l=0;l<k.length;l++)-1<y.indexOf(h)?g+=h+" "+k[l]+";"+(a?"":"\n"):(n=z(k[l],a,c,d+f,e),""!==n&&(g=a?g+(h.replace(/\s*(,|:)\s*/g,"$1")+"{"+n+"}"):g+(d+h.replace(/\s*,\s*/g,",\n"+d)+" {\n"+n+d+"}\n")));else g=-1<y.indexOf(h)?g+(h+" "+
k+";"+(a?"":"\n")):a?g+(h+":"+k.trim().replace(/\s*,\s*/g,",")+";"):g+((d.length<f.length?f:d)+h+": "+k+";\n")}return g}function Q(b){b=b.trim();if("@"!==b.charAt(0))return 1;b=b.substr(1);var a=b.indexOf(" ");0<=a&&(b=b.substr(0,a));a=b;if(-1<b.indexOf("-")){b=b.split("-");var c;a=b[0];for(c=1;c<b.length;c++)a+=b[c].charAt(0).toUpperCase()+b[c].substr(1)}return a in H?H[a]:-1}function I(b,a){"@"===a.charAt(0)&&"@"===b.charAt(0)&&(a=a.substr(1));a="/"===a.charAt(0)?a.substr(1):","===a.charAt(0)?", "+
a.substr(1).trim():" "+a;if(0<=b.indexOf(",")||0<a.indexOf(",")){b=b.split(",");var c,d="",e=a.split(",");if(","!==a.charAt(0))for(c=0;c<b.length;c++)for(a=0;a<e.length;a++)d+=b[c]+e[a]+", ";else for(c=0;c<b.length;c++)d+=b[c]+a+", ";return d.replace(/,+\s*$/,"")}return b+a}function R(b){var a=b.parentRule?b.parentRule:b.parentStyleSheet,c;for(c=0;c<a.cssRules.length;c++)if(a.cssRules[c]===b){a.deleteRule(c);break}}function A(b,a,c){c||(c=100);a||(a={});b||(b="");for(var d=b.lastIndexOf("$"),e,f=
0,g,h,l,k,n,q;0<=d&&f<c;){f++;g=null;k=b.substr(d+1);e=k.search(/[^\w\.]/);e=0>e?b.length:e+d;n=b.substr(d+1,e-d);q=n.split(".");for(h=0;h<q.length;h++)if(!(1>q[h].length)){l=m(g,1);if(0===h&&q[h]in a)g=a[q[h]];else if(null!==g&&/O|A/.test(l)&&q[h]in g)g=g[q[h]];else if("S"===l&&q[h].match(/^[0-9]+$/))g=g.charAt(q[h]);else{g="$"+n;break}if("F"===m(g,1)){if("("===b.charAt(e+1)){e++;l=k=e;do l=b.indexOf("(",l+1),e=b.indexOf(")",e+1);while(-1<l&&l<e);0>e&&(e=b.length);k=b.substr(k+1,e-k-1);k=k.trim().split(/\s*,\s*/);
g=g.apply(null,k)}else g=g();if("."===b.charAt(e+1))for(e++,l=e,k=b.substr(e+1),e=k.search(/[^\w\.]/),k=k.substr(0,0>e?k.length:e),e=0>e?b.length:e+l,n=b.substr(d+1,e-d),k=k.split("."),l=0;l<k.length;l++)q.push(k[l])}}b=b.substr(0,d)+g+b.substr(e+1);e="$"+n===g?d:e+(g.length-1);if(0>--e)break;d=b.lastIndexOf("$",e)}return b}function S(b,a,c){for(var d=0;d<a.length;d++)a[d]&&a[d].parentStyleSheet&&a[d].parentStyleSheet.ownerNode&&a[d].parentStyleSheet.ownerNode.id===b[4].style_id&&E(b,a[d],c)}function E(b,
a,c,d){var e=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),f=a.type,g=c?c.children:b[0];if(1!==f&&5!==f&&4!==f&&7!==f&&8!==f&&6!==f&&12!==f&&10!==f&&3!==f&&2!==f)w("unsuported type: "+f,b[4]);else return 10===f&&(e=y[2]),3===f&&(e=y[1]),2===f&&(e=y[0]),a._update=!1,1===f&&(a.style._update={}),b[2]++,c={indexElem:a,selector:e,csscSelector:d?d:e,children:!1,parent:c?c:!1,events:{},obj:{},type:f,p:b[2]},g[e]?d=g[e].content.push(c)-1:(g[e]={type:f,content:[c],events:{}},d=0),4===f||7===f||12===f?
(g[e].content[d].children={},S(b,a.cssRules,g[e].content[d])):g[e].content[d].obj=P(a.cssText),c}function t(b,a,c,d,e){if(!e&&!b[1]){var f=b[4].style_id;if(document.getElementById(f)){for(var g=0;10>g;g++)if(!document.getElementById(f+"-"+g)){f=f+"-"+g;break}if(document.getElementById(f))throw Error("cann not create new element..");}g=document.createElement("style");g.setAttribute("type","text/css");g.setAttribute("id",f);g.appendChild(document.createTextNode(""));document.head.appendChild(g);b[1]=
g;b[4].style_id=f}f=e?e.indexElem:b[1].sheet;g=f.cssRules.length;var h="";if(c){var l=m(c,1);if("O"===l)for(var k in c)"F"===m(c[k],1)?(d=c[k](),h+=k+":"+d+"; "):h+=k+":"+c[k]+"; ";else if("F"===l)for(k in d=c(),d)h+=k+":"+d[k]+"; ";else h=c+":"+d+";"}d=a+"{"+h+"}";l=!1;-1<y.indexOf(a)&&(d=a+" "+c);try{"insertRule"in f?f.insertRule(d,g):"appendRule"in f?f.appendRule(d,g):"addRule"in f&&f.addRule(a,h,g),l=E(b,f.cssRules[g],e,a)}catch(n){w((e?'"'+e.selector+'" > ':"")+'"'+a+'" -> '+n,b[4])}return l?
l:E(b,{csscSelector:a,cssText:d,parent:e||!1,type:Q(a),placeholder:!0,cssRules:{},style:{}},e,k)}function T(b,a,c){if(b&&b[a]){var d=c?b[a].content.indexOf(c):-1;c?0<=d&&(b[a].content.splice(d,1),0>=b[a].content.length&&delete b[a]):delete b[a]}}function B(b,a,c){var d=m(a,1),e="A"===m(b,1)?b[0]:b;if("S"===d)return a=A(a,b[3],b[4].parse_vars_limit),c?e[a]?e[a].content:[]:u(b,e[a]?e[a].content:[],a);if("R"===d){d=[];for(var f in e)if(f.match(a))for(g=0;g<e[f].content.length;g++)d.push(e[f].content[g]);
return c?d:u(b,d,a)}if("A"===d){d=[];var g;for(g=0;g<a.length;g++){var h=A(a[g],b[3],b[4].parse_vars_limit);if(e[h])for(f=0;f<e[h].content.length;f++)d.push(e[h].content[f])}return c?d:u(b,d,a)}if(/N|U/.test(d)){d=[];for(f in e)for(g=0;g<e[f].content.length;g++)d.push(e[f].content[g]);return c?d:u(b,d,a)}}function C(b,a,c,d){var e=m(a,1);if(/[RUNAS]/.test(e))return B(b,a,c);F(b,a);return d}function F(b,a,c,d){var e,f,g={};if(!d&&!c){for(e=0;e<r.length;e++)r[e]in a&&(g[r[e]]=a[r[e]]);0<x(g).length&&
F(b,g,c,!0)}for(h in a)if(!(h in g)){d="A"===m(a[h],1)?a[h]:[a[h]];var h=A(h,b[3],b[4].parse_vars_limit);for(e=0;e<d.length;e++)if("@"===h.charAt(0))if(-1<r.indexOf(h))t(b,h,d[e],null,c);else{if(h.match(/^@(media|keyframes|supports)/)||c&&(4===c.type||7===c.type||12===c.type)){var l=h;(f=c)&&!h.match(/^@(media|keyframes|supports)/)&&(h=I(c.csscSelector,h),f=c.parent);var k=t(b,h,null,null,f);k&&k.selector===k.csscSelector||(k&&(R(k.indexElem),T(k.parent?k.parent:b[0],k.selector,k)),f={csscSelector:h,
cssText:h+" {}",parent:f||!1,placeholder:!0,type:Q(h),cssRules:{}},k=E(b,f,f.parent,h));F(b,d[e],k);c&&(c.obj[l]||(c.obj[l]=[]),c.obj[l].push(k))}}else/[Sfi]/.test(m(d[e],1))?(f=c?c.children:b[0],f["*"]||t(b,"*",null,null,c),p(b,[f["*"].content[0]],h,d[e])):(k=t(b,h,null,null,c))&&p(b,[k],d[e])}}function p(b,a,c,d,e){if("i"===m(e,1))if(5===a[e].indexElem.type)w("@font-face rules are readonly.",b[4]);else if(c=A(c,b[3],b[4].parse_vars_limit),a[e].children)p(b,B(a[e].children,null,!0),c,d);else{var f=
m(d,1);if(/O|A/.test(f)){var g="@"===c.charAt(0);f="O"===f?[d]:d;var h,l=I(a[e].selector,c);g&&(l=a[e].parent?I(a[e].parent.selector,c):c);for(h=0;h<f.length;h++)if(d=t(b,l,null,null,g?!1:a[e].parent)){if(g){var k=d;(d=t(b,a[e].selector,null,null,d))||(d=k)}p(b,[d],f[h]);g&&a[e].parent&&(k=a[e].parent,k.obj[c]&&"push"in k.obj[c]||(k.obj[c]=[]),k.obj[c].push(d.parent));a[e].obj[c]&&"push"in a[e].obj[c]||(a[e].obj[c]=[]);a[e].obj[c].push(d)}}else if("F"===f){g=U(b,[a[e]],c);try{h=d(g),p(b,a,c,h,e),
a[e].indexElem.style._update[c]=d}catch(n){w(n,b[4])}}else b=O(d,c,b[4].parse_unit_default),a[e].indexElem.style[c]=b,a[e].obj[c]=b}else if(e=m(c,1),"O"===e?g=x(c).length:"F"===e&&(l=c()),"A"===e||"F"===e&&"A"===m(l,1))for(c="A"===e?c:l,h=0;h<c.length;h++)if(a.length>h)p(b,[a[h]],c[h]);else break;else for(h=0;h<a.length;h++)if("O"===e&&0<g)for(f in c)p(b,a,f,c[f],h);else if("F"===e){for(f in l)p(b,a,f,l[f],h);a[h].indexElem._update=c}else p(b,a,c,d,h)}function U(b,a,c,d){if(!c)return v(b,a,"object");
var e=[],f="",g;for(g=0;g<a.length;g++){var h="";a[g].obj[c]&&(h=a[g].obj[c],"A"===m(h,1)&&(h=v(b,h,"object")));h&&""!==h||(h=a[g].indexElem.style[c]);h&&""!==h||(h=(h=a[g].indexElem.cssText.match(new RegExp(c+"s*:s*(.+?);")))?h[1].trim():"");h&&(f=h,d&&e.push(f))}return d?e:f}function v(b,a,c,d){var e={},f,g,h,l=c;"obj"===c&&(c="object");if("arr"===c||"css"===c||"min"===c)c="array";d||(d=[]);for(f=0;f<a.length;f++)if(!(0<=d.indexOf(a[f]))){if(10===a[f].type||3===a[f].type||2===a[f].type)var k=a[f].obj;
else for(h in k=D({},a[f].obj),a[f].obj)if("A"===m(a[f].obj[h],1))if("objNMD"===c||"array"===c)k[h]=null,delete k[h];else{k[h]=[];for(g=0;g<a[f].obj[h].length;g++)if(!(0<=d.indexOf(a[f].obj[h][g]))){var n=v(b,[a[f].obj[h][g]],c,d)[a[f].obj[h][g].selector];d.push(a[f].obj[h][g]);!n||0>=x(n).length||(k[h][g]=n)}0===k[h].length?delete k[h]:1===k[h].length&&(k[h]=k[h][0])}a[f].children&&(k=D(v(b,B(a[f].children,null,!0),c,d),k));1>x(k).length||("array"===c?(e[a[f].p]={},e[a[f].p][a[f].selector]=k):e[a[f].selector]?
("A"!==m(e[a[f].selector],1)&&(e[a[f].selector]=[e[a[f].selector]]),e[a[f].selector].push(k)):e[a[f].selector]=k,d.push(a[f]))}if("array"===c)return e=x(e,!0),c===l||"arr"===l?e:z(e,"min"===l,b[4].parse_tab_len);b={};for(f=0;f<r.length;f++)e[r[f]]&&(b[r[f]]=e[r[f]]);if(n=0<x(b).length)for(f in e)b[f]||(b[f]=e[f]);return n?b:e}function V(b,a){var c,d;for(c=0;c<a.length;c++){if(!1!==a[c].indexElem._update){var e=a[c].indexElem._update();for(d in e)p(b,a,d,e[d],c)}if(a[c].children)V(b,B(a[c].children,
null,!0));else if(a[c].indexElem.style)for(d in a[c].indexElem.style._update)p(b,a,d,a[c].indexElem.style._update[d](),c)}}function J(b,a,c,d){var e=!!m(c,1).match(/[NU]/),f,g=[];for(f=0;f<a.length;f++)a[f].children&&J(b,B(a[f].children,null,!0),c,d),e?(R(a[f].indexElem),T(a[f].parent?a[f].parent:b[0],a[f].selector,a[f])):(g.push(a[f]),a[f].indexElem.style[c]="",a[f].obj[c]&&("A"===m(a[f].obj[c],1)&&J(b,a[f].obj[c]),delete a[f].obj[c]));d&&(d.e=K(b,g))}function L(b,a,c,d,e){0>c&&(c+=a.length);return a[c]?
u(b,[a[c]],d,!1,a[c].parent?a[c].parent:!1):u(b,[],d,!1,e)}function K(b,a){for(var c=[],d=0;d<a.length;d++)a[d].indexElem&&c.push(a[d].indexElem.placeholder?v(b,[a[d]],"obj"):a[d].indexElem);return c}function u(b,a,c,d,e){function f(){if(1>a.length&&!d&&"S"===m(c,1)){var f,l=[],k,n=e?e:[null];for(k=0;k<n.length;k++)(f=t(b,c,null,null,n[k]))&&l.push(f);a=l;g.e=K(b,a);g.selector=1===a.length?a[0].selector:c}}var g=function(c){var d,e,g=[];f();for(d=0;d<a.length;d++)if(a[d].children){var h=C(a[d].children,
c,!0);for(e=0;e<h.length;e++)g.push(h[e])}return u(b,g,c,null,a)};g.e=K(b,a);g.selector=1===a.length?a[0].selector:c;N(g,{set:function(c,d){f();p(b,a,c,d);return g},get:function(c,d){return U(b,a,c,d)},update:function(){V(b,a);return g},"delete":function(c){J(b,a,c,g);return g},"export":function(c){return v(b,a,c)},parse:function(c){return v(b,a,c?"min":"css")},pos:function(d){return L(b,a,d,c,e)},first:function(){return L(b,a,0,c,e)},last:function(){return L(b,a,-1,c,e)}});return g}function W(b,
a,c,d){var e=m(a,1);if("O"===e)D(b,a);else if("S"===e){if("U"===m(c,1))return b[a];b[a]=c}else{if("A"===e){c={};for(d=0;d<a.length;d++)c[a[d]]=b[a[d]];return c}if("U"===e)return b}return d}function X(){var b=[{},!1,0,{},{}],a=function(c){try{return C(b,c,!1,a)}catch(d){w(d,b[4])}};N(a,{version:"1.0b",init:function(c){c="length"in c?c:[c];for(var d=0;d<c.length;d++)if("sheet"in c[d]&&(c[d]=c[d].sheet),"cssRules"in c[d])try{S(b,c[d].cssRules,null)}catch(e){w('Cannot init CSS from "'+c[d].href+'"',b[4])}return a},
"import":function(c){F(b,c);return a},"export":function(a){return C(b).export(a)},parse:function(a){return C(b).parse(a)},update:function(c){C(b,c).update();return a},"new":function(){return X()},conf:function(c,d){return W(b[4],c,d,a)},vars:function(c,d){return W(b[3],c,d,a)},parseVars:function(a,d){return A(a,d?D({},b[3],d):b[3],b[4].parse_vars_limit)},objFromCss:function(a){return P(a)},cssFromObj:function(a,b,e){return z(a,b,e)},_conf:Y,type:H,type_export:Z,messages:M});a.conf(Y);return a}var H=
G({rule:1,charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,viewport:15}),Z=G({css:"css",min:"min",obj:"obj",arr:"arr",object:"object",notMDObject:"objNMD",array:"array"}),Y=G({style_id:"cssc-style",view_err:!0,parse_tab_len:2,parse_unit_default:"px",parse_vars_limit:100}),r=["@charset","@import","@namespace","@font-face"],y=r.slice(0,3),M=[];return X()}();
