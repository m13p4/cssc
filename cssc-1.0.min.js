/* CSSC.js | @version 1.0b |  m13p4 */
var CSSC=function(){function n(c,a,b){if(b)return Object.prototype.toString.call(c);b=Object.prototype.toString.call(c).replace(/(^\[.+\s|\]$)/g,"");"Number"===b&&(b=Math.floor(c)===c?"integer":"float");return a?b.substr(0,a):b}function A(){if(Object.assign)return Object.assign.apply(null,arguments);var c,a;for(a=1;a<arguments.length;a++)for(c in arguments[a])arguments[0][c]=arguments[a][c];return arguments[0]}function K(c,a){var b;if(Object.defineProperty)for(b in a)Object.defineProperty(c,b,{enumerable:!0,
value:a[b]});else for(b in a)c[b]=a[b]}function D(c){if(Object.freeze)return Object.freeze(c);if(Object.defineProperty){var a={},b;for(b in c)Object.defineProperty(a,b,{enumerable:!0,value:c[b]});c=a}Object.preventExtensions&&Object.preventExtensions(c);return c}function u(c,a){if(!a&&Object.keys)return Object.keys(c);if(a&&Object.values)return Object.values(c);var b=[],d;for(d in c)b.push(a?c[d]:d);return b}function L(c,a){a||(a="px");if(isFinite(c))return 0===c%1?""+c+a:""+Math.floor(100*c)/100+
a;if("S"===n(c,1)){var b=c.split(" ");if(1<b.length){for(c=0;c<b.length;c++)b[c]=L(b[c],a);return b.join(" ")}}return c}function M(c){if(c.match(/^@(namespace|import|charset)/))return c.replace(/(^@(namespace|import|charset)\s*|\s*;\s*$)/g,"");var a=c.replace(/(^.*?{\s*|\s*}\s*$)/g,"");c=a.split(";");var b={};if(""!==a)for(a=0;a<c.length;a++)if(""!==c[a]){var d=c[a].split(":");b[d[0].trim()]=d.slice(1).join(":").trim()}return b}function x(c,a,b,d,e){var f=Array((parseInt(b)||2)+1).join(" "),h="",
g,l=n(c,1);d=d||"";if("S"===l)return c;if("A"===l)for(l=0;l<c.length;l++)h+=x(c[l],a,b,d,!0);else for(g in c){var k=""+c[g];l=n(c[g],1);if("O"===l||"A"===l)if(e&&"A"===l){var m=x(c[g],a,b,d+f,e);""!==m&&(h=a?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n"))}else for("O"===l&&(k=[c[g]]),l=0;l<k.length;l++)"@namespace"===g||"@import"===g||"@charset"===g?h+=g+" "+k[l]+";"+(a?"":"\n"):(m=x(k[l],a,b,d+f,e),""!==m&&(h=a?h+(g.replace(/\s*(,|:)\s*/g,"$1")+
"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n")));else h="@namespace"===g||"@import"===g||"@charset"===g?h+(g+" "+k+";"+(a?"":"\n")):a?h+(g+":"+k.trim().replace(/\s*,\s*/g,",")+";"):h+((d.length<f.length?f:d)+g+": "+k+";\n")}return h}function N(c){c=c.trim();if("@"!==c.charAt(0))return 1;c=c.substr(1);var a=c.indexOf(" ");0<=a&&(c=c.substr(0,a));a=c;if(0<=c.indexOf("-")){c=c.split("-");var b;a=c[0];for(b=1;b<c.length;b++)a+=c[b].charAt(0).toUpperCase()+c[b].substr(1)}return a in E?
E[a]:-1}function F(c,a){"@"===a.charAt(0)&&"@"===c.charAt(0)&&(a=a.substr(1));a="/"===a.charAt(0)?a.substr(1):","===a.charAt(0)?", "+a.substr(1).trim():" "+a;if(0<=c.indexOf(",")||0<a.indexOf(",")){c=c.split(",");var b,d="",e=a.split(",");if(","!==a.charAt(0))for(b=0;b<c.length;b++)for(a=0;a<e.length;a++)d+=c[b]+e[a]+", ";else for(b=0;b<c.length;b++)d+=c[b]+a+", ";return d.replace(/,+\s*$/,"")}return c+a}function O(c){var a=c.parentRule?c.parentRule:c.parentStyleSheet,b;for(b=0;b<a.cssRules.length;b++)if(a.cssRules[b]===
c){a.deleteRule(b);break}}function G(c,a,b){b||(b=100);a||(a={});c||(c="");for(var d=c.lastIndexOf("$"),e,f=0,h,g,l,k,m,q;0<=d&&f<b;){f++;h=null;k=c.substr(d+1);e=k.search(/[^\w\.]/);e=0>e?c.length:e+d;m=c.substr(d+1,e-d);q=m.split(".");for(g=0;g<q.length;g++)if(!(1>q[g].length)){l=n(h,1);if(0===g&&q[g]in a)h=a[q[g]];else if(null!==h&&l.match(/[OA]/)&&q[g]in h)h=h[q[g]];else if("S"===l&&q[g].match(/^[0-9]+$/))h=h.charAt(q[g]);else{h="$"+m;break}if("F"===n(h,1)){if("("===c.charAt(e+1)){e++;l=k=e;do l=
c.indexOf("(",l+1),e=c.indexOf(")",e+1);while(-1<l&&l<e);0>e&&(e=c.length);k=c.substr(k+1,e-k-1);k=k.trim().split(/\s*,\s*/);h=h.apply(null,k)}else h=h();if("."===c.charAt(e+1))for(e++,l=e,k=c.substr(e+1),e=k.search(/[^\w\.]/),k=k.substr(0,0>e?k.length:e),e=0>e?c.length:e+l,m=c.substr(d+1,e-d),k=k.split("."),l=0;l<k.length;l++)q.push(k[l])}}c=c.substr(0,d)+h+c.substr(e+1);e="$"+m===h?d:e+(h.length-1);if(0>--e)break;d=c.lastIndexOf("$",e)}return c}function P(c,a,b){for(var d=0;d<a.length;d++)a[d]&&
a[d].parentStyleSheet&&a[d].parentStyleSheet.ownerNode&&a[d].parentStyleSheet.ownerNode.id===c[4].style_id&&B(c,a[d],b)}function B(c,a,b,d){var e=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),f=a.type,h=b?b.children:c[0];if(1!==f&&5!==f&&4!==f&&7!==f&&8!==f&&6!==f&&12!==f&&10!==f&&3!==f&&2!==f)console.log("unsuported type: "+f);else return 10===f&&(e="@namespace"),3===f&&(e="@import"),2===f&&(e="@charset"),a._update=!1,1===f&&(a.style._update={}),c[2]++,b={indexElem:a,selector:e,csscSelector:d?
d:e,children:!1,parent:b?b:!1,events:{},obj:{},type:f,p:c[2]},h[e]?d=h[e].content.push(b)-1:(h[e]={type:f,content:[b],events:{}},d=0),4===f||7===f||12===f?(h[e].content[d].children={},P(c,a.cssRules,h[e].content[d])):h[e].content[d].obj=M(a.cssText),b}function v(c,a,b,d,e){var f;if(!e&&!c[1]){if(document.getElementById(c[4].style_id)){for(f=0;10>f;f++)if(!document.getElementById(c[4].style_id+"-"+f)){c[4].style_id=c[4].style_id+"-"+f;break}if(document.getElementById(c[4].style_id))throw Error("cann not create new element..");
}f=document.createElement("style");f.setAttribute("type","text/css");f.setAttribute("id",c[4].style_id);f.appendChild(document.createTextNode(""));document.head.appendChild(f);c[1]=f}f=e?e.indexElem:c[1].sheet;var h=f.cssRules.length,g="";if(b){var l=n(b,1);if("O"===l)for(var k in b)"F"===n(b[k],1)?(d=b[k](),g+=k+":"+d+"; "):g+=k+":"+b[k]+"; ";else if("F"===l)for(k in d=b(),d)g+=k+":"+d[k]+"; ";else g=b+":"+d+";"}d=a+"{"+g+"}";l=!1;if("@namespace"===a||"@import"===a||"@charset"===a)d=a+" "+b;try{"insertRule"in
f?f.insertRule(d,h):"appendRule"in f?f.appendRule(d,h):"addRule"in f&&f.addRule(a,g,h),l=B(c,f.cssRules[h],e,a)}catch(m){b=(e?'"'+e.selector+'" > ':"")+'"'+a+'" -> '+m,c[4].view_err&&console.log(b),w.push(b)}return l?l:B(c,{csscSelector:a,cssText:d,parent:e||!1,type:N(a),placeholder:!0,cssRules:{},style:{}},e,k)}function Q(c,a,b){if(c&&c[a]){var d=b?c[a].content.indexOf(b):-1;b?0<=d&&(c[a].content.splice(d,1),0>=c[a].content.length&&delete c[a]):delete c[a]}}function y(c,a,b){var d=n(a,1),e="A"===
n(c,1)?c[0]:c;if("S"===d)return b?e[a]?e[a].content:[]:r(c,e[a]?e[a].content:[],a);if("R"===d){d=[];for(var f in e)if(f.match(a))for(h=0;h<e[f].content.length;h++)d.push(e[f].content[h]);return b?d:r(c,d,a)}if("A"===d){d=[];var h;for(h=0;h<a.length;h++)if(e[a])for(f=0;f<e[a].content.length;f++)d.push(e[a].content[f]);return b?d:r(c,d,a)}if("N"===d||"U"===d){d=[];for(f in e)for(h=0;h<e[f].content.length;h++)d.push(e[f].content[h]);return b?d:r(c,d,a)}return null}function z(c,a,b,d){var e=n(a,1);if("R"===
e||"U"===e||"N"===e||"A"===e||"S"===e)return y(c,a,b);C(c,a);return d}function C(c,a,b,d){var e,f,h={};d||b||("@charset"in a&&(h["@charset"]=a["@charset"]),"@import"in a&&(h["@import"]=a["@import"]),"@namespace"in a&&(h["@namespace"]=a["@namespace"]),"@font-face"in a&&(h["@font-face"]=a["@font-face"]),0<u(h).length&&C(c,h,b,!0));for(g in a)if(!(g in h)){d="A"===n(a[g],1)?a[g]:[a[g]];var g=G(g,c[3],c[4].parse_vars_limit);for(e=0;e<d.length;e++)if("@"===g.charAt(0))if("@font-face"===g||"@namespace"===
g||"@import"===g||"@charset"===g)v(c,g,d[e],null,b);else{if(g.match(/^@(media|keyframes|supports)/)||b&&(4===b.type||7===b.type||12===b.type)){var l=g;(f=b)&&!g.match(/^@(media|keyframes|supports)/)&&(g=F(b.csscSelector,g),f=b.parent);var k=v(c,g,null,null,f);k&&k.selector===k.csscSelector||(k&&(O(k.indexElem),Q(k.parent?k.parent:c[0],k.selector,k)),f={csscSelector:g,cssText:g+" {}",parent:f||!1,placeholder:!0,type:N(g),cssRules:{}},k=B(c,f,f.parent,g));C(c,d[e],k);b&&(b.obj[l]||(b.obj[l]=[]),b.obj[l].push(k))}}else(k=
v(c,g,null,null,b))&&p(c,[k],d[e])}}function p(c,a,b,d,e){if("i"===n(e,1))if(5===a[e].indexElem.type)c[4].view_err&&console.log("@font-face rules are readonly."),w.push("@font-face rules are readonly.");else if(b=G(b,c[3],c[4].parse_vars_limit),a[e].children)p(c,y(a[e].children,null,!0),b,d);else{var f=n(d,1);if("O"===f||"A"===f){var h="@"===b.charAt(0);f="O"===f?[d]:d;var g,l=F(a[e].selector,b);h&&(l=a[e].parent?F(a[e].parent.selector,b):b);for(g=0;g<f.length;g++)if(d=v(c,l,null,null,h?!1:a[e].parent)){if(h){var k=
d;(d=v(c,a[e].selector,null,null,d))||(d=k)}p(c,[d],f[g]);h&&a[e].parent&&(k=a[e].parent,k.obj[b]&&"push"in k.obj[b]||(k.obj[b]=[]),k.obj[b].push(d.parent));a[e].obj[b]&&"push"in a[e].obj[b]||(a[e].obj[b]=[]);a[e].obj[b].push(d)}}else if("F"===f){h=R(c,[a[e]],b);try{g=d(h),p(c,a,b,g,e),a[e].indexElem.style._update[b]=d}catch(m){c[4].view_err&&console.log(m),w.push(m)}}else c=L(d,c[4].parse_unit_default),a[e].indexElem.style[b]=c,a[e].obj[b]=c}else if(e=n(b,1),"O"===e?h=u(b).length:"F"===e&&(l=b()),
"A"===e||"F"===e&&"A"===n(l,1))for(b="A"===e?b:l,g=0;g<b.length;g++)if(a.length>g)p(c,[a[g]],b[g]);else break;else for(g=0;g<a.length;g++)if("O"===e&&0<h)for(f in b)p(c,a,f,b[f],g);else if("F"===e){for(f in l)p(c,a,f,l[f],g);a[g].indexElem._update=b}else p(c,a,b,d,g)}function R(c,a,b,d){if(!b)return t(c,a,"object");var e=[],f="",h;d=!!d;for(h=0;h<a.length;h++){var g="";a[h].obj[b]&&(g=a[h].obj[b],"A"===n(g,1)&&(g=t(c,g,"object")));g&&""!==g||(g=a[h].indexElem.style[b]);g&&""!==g||(g=(g=a[h].indexElem.cssText.match(new RegExp(b+
"s*:s*(.+?);")))?g[1].trim():"");g&&(f=g,d&&e.push(f))}return d?e:f}function t(c,a,b,d){var e={},f,h,g,l=b;"obj"===b&&(b="object");if("arr"===b||"css"===b||"min"===b)b="array";d||(d=[]);for(f=0;f<a.length;f++)if(!(0<=d.indexOf(a[f]))){if(10===a[f].type||3===a[f].type||2===a[f].type)var k=a[f].obj;else for(g in k=A({},a[f].obj),a[f].obj)if("A"===n(a[f].obj[g],1))if("objNMD"===b||"array"===b)k[g]=null,delete k[g];else{k[g]=[];for(h=0;h<a[f].obj[g].length;h++)if(!(0<=d.indexOf(a[f].obj[g][h]))){var m=
t(c,[a[f].obj[g][h]],b,d)[a[f].obj[g][h].selector];d.push(a[f].obj[g][h]);!m||0>=u(m).length||(k[g][h]=m)}0===k[g].length?delete k[g]:1===k[g].length&&(k[g]=k[g][0])}a[f].children&&(k=A(t(c,y(a[f].children,null,!0),b,d),k));1>u(k).length||("array"===b?(e[a[f].p]={},e[a[f].p][a[f].selector]=k):e[a[f].selector]?("A"!==n(e[a[f].selector],1)&&(e[a[f].selector]=[e[a[f].selector]]),e[a[f].selector].push(k)):e[a[f].selector]=k,d.push(a[f]))}if("array"===b)return e=u(e,!0),b===l||"arr"===l?e:x(e,"min"===
l,c[4].parse_tab_len);c={};e["@charset"]&&(c["@charset"]=e["@charset"]);e["@import"]&&(c["@import"]=e["@import"]);e["@namespace"]&&(c["@namespace"]=e["@namespace"]);e["@font-face"]&&(c["@font-face"]=e["@font-face"]);if(m=0<u(c).length)for(f in e)c[f]||(c[f]=e[f]);return m?c:e}function S(c,a){var b,d;for(b=0;b<a.length;b++){if(!1!==a[b].indexElem._update){var e=a[b].indexElem._update();for(d in e)p(c,a,d,e[d],b)}if(a[b].children)S(c,y(a[b].children,null,!0));else if(a[b].indexElem.style)for(d in a[b].indexElem.style._update)p(c,
a,d,a[b].indexElem.style._update[d](),b)}}function H(c,a,b,d){var e=!!n(b,1).match(/[NU]/),f,h=[];for(f=0;f<a.length;f++)a[f].children&&H(c,y(a[f].children,null,!0),b,d),e?(O(a[f].indexElem),Q(a[f].parent?a[f].parent:c[0],a[f].selector,a[f])):(h.push(a[f]),a[f].indexElem.style[b]="",a[f].obj[b]&&("A"===n(a[f].obj[b],1)&&H(c,a[f].obj[b]),delete a[f].obj[b]));d&&(d.e=I(c,h))}function J(c,a,b,d,e){0>b&&(b+=a.length);return a[b]?r(c,[a[b]],d,!1,a[b].parent?a[b].parent:!1):r(c,[],d,!1,e)}function I(c,
a){for(var b=[],d=0;d<a.length;d++)a[d].indexElem&&b.push(a[d].indexElem.placeholder?t(c,[a[d]],"obj"):a[d].indexElem);return b}function r(c,a,b,d,e){function f(){if(1>a.length&&!d&&"S"===n(b,1)){var f,l=[],k,m=e?e:[null];for(k=0;k<m.length;k++)(f=v(c,b,null,null,m[k]))&&l.push(f);a=l;h.e=I(c,a);h.selector=1===a.length?a[0].selector:b}}var h=function(b){var d,e,g=[];f();for(d=0;d<a.length;d++)if(a[d].children){var h=z(a[d].children,b,!0);for(e=0;e<h.length;e++)g.push(h[e])}return r(c,g,b,null,a)};
h.e=I(c,a);h.selector=1===a.length?a[0].selector:b;K(h,{set:function(b,d,e){f();p(c,a,b,d,e);return h},get:function(b,d){return R(c,a,b,d)},update:function(){S(c,a);return h},"delete":function(b){H(c,a,b,h);return h},"export":function(b){return t(c,a,b)},parse:function(b){return t(c,a,b?"min":"css")},pos:function(d){return J(c,a,d,b,e)},first:function(){return J(c,a,0,b,e)},last:function(){return J(c,a,-1,b,e)}});return h}function T(c,a,b,d){var e=n(a,1);if("O"===e)A(c,a);else if("S"===e){if("U"===
n(b,1))return c[a];c[a]=b}else{if("A"===e){b={};for(d=0;d<a.length;d++)b[a[d]]=c[a[d]];return b}if("U"===e)return c}return d}function U(){var c=[{},!1,0,{},{}],a=function(b){try{return z(c,b,!1,a)}catch(d){c[4].view_err&&console.log(d),w.push(d)}};K(a,{version:"1.0b",init:function(b){b="length"in b?b:[b];for(var d=0;d<b.length;d++)if("sheet"in b[d]&&(b[d]=b[d].sheet),"cssRules"in b[d])try{P(c,b[d].cssRules,null)}catch(e){c[4].view_err&&console.log('Cannot init CSS from "'+b[d].href+'"'),w.push('Cannot init CSS from "'+
b[d].href+'"')}return a},"import":function(b){C(c,b);return a},"export":function(a){return z(c).export(a)},parse:function(a){return z(c).parse(a)},update:function(b){z(c,b).update();return a},"new":function(){return U()},conf:function(b,d){return T(c[4],b,d,a)},vars:function(b,d){return T(c[3],b,d,a)},parseVars:function(a,d){return G(a,d?A({},c[3],d):c[3],c[4].parse_vars_limit)},objFromCss:function(a){return M(a)},cssFromObj:function(a,c,e){return x(a,c,e)},_conf:V,type:E,type_export:W,messages:w});
a.conf(V);return a}var E=D({rule:1,charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,viewport:15}),W=D({css:"css",min:"min",obj:"obj",arr:"arr",object:"object",notMDObject:"objNMD",array:"array"}),V=D({style_id:"cssc-style",view_err:!0,parse_tab_len:2,parse_unit_default:"px",parse_vars_limit:100}),w=[];return U()}();
