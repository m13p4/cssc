/* CSSC.js | @version 1.0b |  m13p4 */
var CSSC=function(){function n(c,a,b){if(b)return Object.prototype.toString.call(c);b=Object.prototype.toString.call(c).replace(/(^\[.+\s|\]$)/g,"");"Number"===b&&(b=Math.floor(c)===c?"integer":"float");return a?b.substr(0,a):b}function B(){if(Object.assign)return Object.assign.apply(null,arguments);var c,a;for(a=1;a<arguments.length;a++)for(c in arguments[a])arguments[0][c]=arguments[a][c];return arguments[0]}function J(c,a){var b;if(Object.defineProperty)for(b in a)Object.defineProperty(c,b,{enumerable:!0,
value:a[b]});else for(b in a)c[b]=a[b]}function C(c){if(Object.freeze)return Object.freeze(c);if(Object.defineProperty){var a={},b;for(b in c)Object.defineProperty(a,b,{enumerable:!0,value:c[b]});c=a}Object.preventExtensions&&Object.preventExtensions(c);return c}function K(c){if(isFinite(c))return 0===c%1?c+"px":Math.floor(100*c)/100+"px";if("S"===n(c,1)){var a=c.split(" ");if(1<a.length){for(c=0;c<a.length;c++)a[c]=K(a[c]);return a.join(" ")}}return c}function L(c){if(c.match(/^@(namespace|import|charset)/))return c.replace(/(^@(namespace|import|charset)\s*|\s*;\s*$)/g,
"");var a=c.replace(/(^.*?{\s*|\s*}\s*$)/g,"");c=a.split(";");var b={};if(""!==a)for(a=0;a<c.length;a++)if(""!==c[a]){var d=c[a].split(":");b[d[0].trim()]=d.slice(1).join(":").trim()}return b}function v(c,a,b,d,f){var e=Array((parseInt(b)||2)+1).join(" "),h="",g,l=n(c,1);d=d||"";if("S"===l)return c;if("A"===l)for(l=0;l<c.length;l++)h+=v(c[l],a,b,d,!0);else for(g in c){var k=c[g];l=n(c[g],1);if("O"===l||"A"===l)if(f&&"A"===l){var m=v(c[g],a,b,d+e,f);""!==m&&(h=a?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+
m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n"))}else for("O"===l&&(k=[c[g]]),l=0;l<k.length;l++)"@namespace"===g||"@import"===g||"@charset"===g?h+=g+" "+k[l]+";"+(a?"":"\n"):(m=v(k[l],a,b,d+e,f),""!==m&&(h=a?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n")));else h="@namespace"===g||"@import"===g||"@charset"===g?h+(g+" "+k+";"+(a?"":"\n")):a?h+(g+":"+k.trim().replace(/\s*,\s*/g,",")+";"):h+((d.length<e.length?e:d)+g+": "+k+";\n")}return h}
function M(c){c=c.trim();if("@"!==c.charAt(0))return 1;c=c.substr(1);var a=c.indexOf(" ");0<=a&&(c=c.substr(0,a));a=c;if(0<=c.indexOf("-")){c=c.split("-");var b;a=c[0];for(b=1;b<c.length;b++)a+=c[b].charAt(0).toUpperCase()+c[b].substr(1)}return a in D?D[a]:-1}function E(c,a){"@"===a.charAt(0)&&"@"===c.charAt(0)&&(a=a.substr(1));a="/"===a.charAt(0)?a.substr(1):","===a.charAt(0)?", "+a.substr(1).trim():" "+a;if(0<=c.indexOf(",")||0<a.indexOf(",")){c=c.split(",");var b,d="",f=a.split(",");if(","!==a.charAt(0))for(b=
0;b<c.length;b++)for(a=0;a<f.length;a++)d+=c[b]+f[a]+", ";else for(b=0;b<c.length;b++)d+=c[b]+a+", ";return d.replace(/,+\s*$/,"")}return c+a}function N(c){var a=c.parentRule?c.parentRule:c.parentStyleSheet,b;for(b=0;b<a.cssRules.length;b++)if(a.cssRules[b]===c){a.deleteRule(b);break}}function F(c,a){a?"A"!==n(a,1)&&(a=[a]):a=[{}];c||(c="");for(var b=c.lastIndexOf("$"),d,f=0,e,h,g,l,k,m;0<=b&&100>f;){f++;e=null;l=c.substr(b+1);d=l.search(/[^\w\.]/);d=0>d?c.length:d+b;k=c.substr(b+1,d-b);m=k.split(".");
for(h=0;h<m.length;h++)if(!(1>m[h].length)){g=n(e,1);if(0===h)for(g=a.length-1;0<=g;g--){if(m[h]in a[g]){e=a[g][m[h]];break}}else if(null!==e&&g.match(/[OA]/)&&m[h]in e)e=e[m[h]];else if("S"===g&&m[h].match(/^[0-9]+$/))e=e.charAt(m[h]);else{e="$"+k;break}if("F"===n(e,1)){if("("===c.charAt(d+1)){d++;g=l=d;do g=c.indexOf("(",g+1),d=c.indexOf(")",d+1);while(-1<g&&g<d);0>d&&(d=c.length);l=c.substr(l+1,d-l-1);l=l.trim().split(/\s*,\s*/);e=e.apply(null,l)}else e=e();if("."===c.charAt(d+1))for(d++,g=d,l=
c.substr(d+1),d=l.search(/[^\w\.]/),l=l.substr(0,0>d?l.length:d),d=0>d?c.length:d+g,k=c.substr(b+1,d-b),l=l.split("."),g=0;g<l.length;g++)m.push(l[g])}}c=c.substr(0,b)+e+c.substr(d+1);d="$"+k===e?b:d+(e.length-1);if(0>--d)break;b=c.lastIndexOf("$",d)}return c}function O(c,a,b){for(var d=0;d<a.length;d++)a[d]&&a[d].parentStyleSheet&&a[d].parentStyleSheet.ownerNode&&a[d].parentStyleSheet.ownerNode.id===c[4].styleId&&z(c,a[d],b)}function z(c,a,b,d){var f=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),
e=a.type,h=b?b.children:c[0];if(1!==e&&5!==e&&4!==e&&7!==e&&8!==e&&6!==e&&12!==e&&10!==e&&3!==e&&2!==e)console.log("unsuported type: "+e);else return 10===e&&(f="@namespace"),3===e&&(f="@import"),2===e&&(f="@charset"),a._update=!1,1===e&&(a.style._update={}),c[2]++,w[2]++,b={indexElem:a,selector:f,csscSelector:d?d:f,children:!1,parent:b?b:!1,events:{},obj:{},type:e,p:c[2],_p:w[2]},h[f]?d=h[f].content.push(b)-1:(h[f]={type:e,content:[b],events:{}},d=0),4===e||7===e||12===e?(h[f].content[d].children=
{},O(c,a.cssRules,h[f].content[d])):h[f].content[d].obj=L(a.cssText),w[0][f]?w[0][f].content.push(b):w[0][f]={type:e,content:[b],events:{}},b}function t(c,a,b,d,f){var e;if(!f&&!c[1]){if(document.getElementById(c[4].styleId)){for(e=0;10>e;e++)if(!document.getElementById(c[4].styleId+"-"+e)){c[4].styleId=c[4].styleId+"-"+e;break}if(document.getElementById(c[4].styleId))throw Error("cann not create new element..");}e=document.createElement("style");e.setAttribute("type","text/css");e.setAttribute("id",
c[4].styleId);e.appendChild(document.createTextNode(""));document.head.appendChild(e);c[1]=e}e=f?f.indexElem:c[1].sheet;var h=e.cssRules.length,g="";if(b){var l=n(b,1);if("O"===l)for(var k in b)"F"===n(b[k],1)?(d=b[k](),g+=k+":"+d+"; "):g+=k+":"+b[k]+"; ";else if("F"===l)for(k in d=b(),d)g+=k+":"+d[k]+"; ";else g=b+":"+d+";"}d=a+"{"+g+"}";l=!1;if("@namespace"===a||"@import"===a||"@charset"===a)d=a+" "+b;try{"insertRule"in e?e.insertRule(d,h):"appendRule"in e?e.appendRule(d,h):"addRule"in e&&e.addRule(a,
g,h),l=z(c,e.cssRules[h],f,a)}catch(m){b=(f?'"'+f.selector+'" > ':"")+'"'+a+'" -> '+m,c[4].viewErr&&console.log(b),u.push(b)}return l?l:z(c,{csscSelector:a,cssText:d,parent:f||!1,type:M(a),placeholder:!0,cssRules:{},style:{}},f,k)}function P(c,a,b){if(c&&c[a]){var d=b?c[a].content.indexOf(b):-1;b?0<=d&&(c[a].content.splice(d,1),0>=c[a].content.length&&delete c[a]):delete c[a]}}function x(c,a,b){var d=n(a,1),f="A"===n(c,1)?c[0]:c;if("S"===d)return b?f[a]?f[a].content:[]:q(c,f[a]?f[a].content:[],a);
if("R"===d){d=[];for(var e in f)if(e.match(a))for(h=0;h<f[e].content.length;h++)d.push(f[e].content[h]);return b?d:q(c,d,a)}if("A"===d){d=[];var h;for(h=0;h<a.length;h++)if(f[a])for(e=0;e<f[a].content.length;e++)d.push(f[a].content[e]);return b?d:q(c,d,a)}if("N"===d||"U"===d){d=[];for(e in f)for(h=0;h<f[e].content.length;h++)d.push(f[e].content[h]);return b?d:q(c,d,a)}return null}function y(c,a,b,d){var f=n(a,1);if("R"===f||"U"===f||"N"===f||"A"===f||"S"===f)return x(c,a,b);A(c,a);return d}function A(c,
a,b,d){var f,e,h={};d||b||("@charset"in a&&(h["@charset"]=a["@charset"]),"@import"in a&&(h["@import"]=a["@import"]),"@namespace"in a&&(h["@namespace"]=a["@namespace"]),"@font-face"in a&&(h["@font-face"]=a["@font-face"]),0<Object.keys(h).length&&A(c,h,b,!0));for(g in a)if(!(g in h)){d="A"===n(a[g],1)?a[g]:[a[g]];var g=F(g,c[3]);for(f=0;f<d.length;f++)if("@"===g.charAt(0))if("@font-face"===g||"@namespace"===g||"@import"===g||"@charset"===g)t(c,g,d[f],null,b);else{if(g.match(/^@(media|keyframes|supports)/)||
b&&(4===b.type||7===b.type||12===b.type)){var l=g;(e=b)&&!g.match(/^@(media|keyframes|supports)/)&&(g=E(b.csscSelector,g),e=b.parent);var k=t(c,g,null,null,e);k&&k.selector===k.csscSelector||(k&&(N(k.indexElem),P(k.parent?k.parent:c[0],k.selector,k)),e={csscSelector:g,cssText:g+" {}",parent:e||!1,placeholder:!0,type:M(g),cssRules:{}},k=z(c,e,e.parent,g));A(c,d[f],k);b&&(b.obj[l]||(b.obj[l]=[]),b.obj[l].push(k))}}else(k=t(c,g,null,null,b))&&p(c,[k],d[f])}}function p(c,a,b,d,f){if("i"===n(f,1))if(5===
a[f].indexElem.type)c[4].viewErr&&console.log("@font-face rules are readonly."),u.push("@font-face rules are readonly.");else if(b=F(b,c[3]),a[f].children)p(c,x(a[f].children,null,!0),b,d);else{var e=n(d,1);if("O"===e||"A"===e){var h="@"===b.charAt(0);e="O"===e?[d]:d;var g,l=E(a[f].selector,b);h&&(l=a[f].parent?E(a[f].parent.selector,b):b);for(g=0;g<e.length;g++)if(d=t(c,l,null,null,h?!1:a[f].parent)){if(h){var k=d;(d=t(c,a[f].selector,null,null,d))||(d=k)}p(c,[d],e[g]);h&&a[f].parent&&(k=a[f].parent,
k.obj[b]&&"push"in k.obj[b]||(k.obj[b]=[]),k.obj[b].push(d.parent));a[f].obj[b]&&"push"in a[f].obj[b]||(a[f].obj[b]=[]);a[f].obj[b].push(d)}}else if("F"===e){h=Q(c,[a[f]],b);try{g=d(h),p(c,a,b,g,f),a[f].indexElem.style._update[b]=d}catch(m){c[4].viewErr&&console.log(m),u.push(m)}}else c=K(d),a[f].indexElem.style[b]=c,a[f].obj[b]=c}else if(f=n(b,1),"O"===f?h=Object.keys(b).length:"F"===f&&(l=b()),"A"===f||"F"===f&&"A"===n(l,1))for(b="A"===f?b:l,g=0;g<b.length;g++)if(a.length>g)p(c,[a[g]],b[g]);else break;
else for(g=0;g<a.length;g++)if("O"===f&&0<h)for(e in b)p(c,a,e,b[e],g);else if("F"===f){for(e in l)p(c,a,e,l[e],g);a[g].indexElem._update=b}else p(c,a,b,d,g)}function Q(c,a,b,d){if(!b)return r(c,a,"object");var f=[],e="",h;d=!!d;for(h=0;h<a.length;h++){var g="";a[h].obj[b]&&(g=a[h].obj[b],"A"===n(g,1)&&(g=r(c,g,"object")));g&&""!==g||(g=a[h].indexElem.style[b]);g&&""!==g||(g=(g=a[h].indexElem.cssText.match(new RegExp(b+"s*:s*(.+?);")))?g[1].trim():"");g&&(e=g,d&&f.push(e))}return d?f:e}function r(c,
a,b,d){var f={},e,h,g,l=b;"obj"===b&&(b="object");if("css"===b||"min"===b)b="array";d||(d=[]);for(e=0;e<a.length;e++)if(!(0<=d.indexOf(a[e]))){if(10===a[e].type||3===a[e].type||2===a[e].type)var k=a[e].obj;else for(g in k=B({},a[e].obj),a[e].obj)if("A"===n(a[e].obj[g],1))if("objNMD"===b||"array"===b)k[g]=null,delete k[g];else{k[g]=[];for(h=0;h<a[e].obj[g].length;h++)if(!(0<=d.indexOf(a[e].obj[g][h]))){var m=r(c,[a[e].obj[g][h]],b,d)[a[e].obj[g][h].selector];d.push(a[e].obj[g][h]);!m||0>=Object.keys(m).length||
(k[g][h]=m)}0===k[g].length?delete k[g]:1===k[g].length&&(k[g]=k[g][0])}a[e].children&&(k=B(r(c,x(a[e].children,null,!0),b,d),k));0>=Object.keys(k).length||("array"===b?(f[a[e].p]={},f[a[e].p][a[e].selector]=k):f[a[e].selector]?("A"!==n(f[a[e].selector],1)&&(f[a[e].selector]=[f[a[e].selector]]),f[a[e].selector].push(k)):f[a[e].selector]=k,d.push(a[e]))}if("array"===b)return f=Object.values(f),b===l?f:v(f,"min"===l,c[4].tabLen);c={};f["@charset"]&&(c["@charset"]=f["@charset"]);f["@import"]&&(c["@import"]=
f["@import"]);f["@namespace"]&&(c["@namespace"]=f["@namespace"]);f["@font-face"]&&(c["@font-face"]=f["@font-face"]);if(m=0<Object.keys(c).length)for(e in f)c[e]||(c[e]=f[e]);return m?c:f}function R(c,a){var b,d;for(b=0;b<a.length;b++){if(!1!==a[b].indexElem._update){var f=a[b].indexElem._update();for(d in f)p(c,a,d,f[d],b)}if(a[b].children)R(c,x(a[b].children,null,!0));else if(a[b].indexElem.style)for(d in a[b].indexElem.style._update)p(c,a,d,a[b].indexElem.style._update[d](),b)}}function G(c,a,b,
d){var f=!!n(b,1).match(/[NU]/),e,h=[];for(e=0;e<a.length;e++)a[e].children&&G(c,x(a[e].children,null,!0),b,d),f?(N(a[e].indexElem),P(a[e].parent?a[e].parent:c[0],a[e].selector,a[e])):(h.push(a[e]),a[e].indexElem.style[b]="",a[e].obj[b]&&("A"===n(a[e].obj[b],1)&&G(c,a[e].obj[b]),delete a[e].obj[b]));d&&(d.e=H(c,h))}function I(c,a,b,d,f){0>b&&(b+=a.length);return a[b]?q(c,[a[b]],d,!1,a[b].parent?a[b].parent:!1):q(c,[],d,!1,f)}function H(c,a){for(var b=[],d=0;d<a.length;d++)a[d].indexElem&&b.push(a[d].indexElem.placeholder?
r(c,[a[d]],"obj"):a[d].indexElem);return b}function q(c,a,b,d,f){function e(){if(1>a.length&&!d&&"S"===n(b,1)){var e,l=[],k,m=f?f:[null];for(k=0;k<m.length;k++)(e=t(c,b,null,null,m[k]))&&l.push(e);a=l;h.e=H(c,a);h.selector=1===a.length?a[0].selector:b}}var h=function(b){var d,f,g=[];e();for(d=0;d<a.length;d++)if(a[d].children){var h=y(a[d].children,b,!0);for(f=0;f<h.length;f++)g.push(h[f])}return q(c,g,b,null,a)};h.e=H(c,a);h.selector=1===a.length?a[0].selector:b;J(h,{set:function(b,d,f){e();p(c,
a,b,d,f);return h},get:function(b,d){return Q(c,a,b,d)},update:function(){R(c,a);return h},"delete":function(b){G(c,a,b,h);return h},"export":function(b){return r(c,a,b)},parse:function(b){return r(c,a,b?"min":"css")},pos:function(d){return I(c,a,d,b,f)},first:function(){return I(c,a,0,b,f)},last:function(){return I(c,a,-1,b,f)}});return h}function S(){var c=[{},!1,0,[],{}],a=function(b){try{return y(c,b,!1,a)}catch(d){c[4].viewErr&&console.log(d),u.push(d)}};J(a,{version:"1.0b",init:function(b){b=
"length"in b?b:[b];for(var d=0;d<b.length;d++)if("sheet"in b[d]&&(b[d]=b[d].sheet),"cssRules"in b[d]){var f=(b[d].ownerNode.getAttribute("data-cssc-ignore")||"").toLowerCase();if("true"!==f&&"1"!==f)try{O(c,b[d].cssRules,null)}catch(e){c[4].viewErr&&console.log('Cannot init CSS from "'+b[d].href+'"'),u.push('Cannot init CSS from "'+b[d].href+'"')}}return a},"import":function(b){A(c,b);return a},"export":function(a){return y(c).export(a)},parse:function(a){return y(c).parse(a)},update:function(b){y(c,
b).update();return a},"new":function(){return S()},defineVars:function(b){c[3]=[b];return a},addVars:function(b){c[3].push(b);return a},getVars:function(){return c[3]},defineConf:function(b){c[4]=B(c[4],b);return a},setConf:function(b,d){c[4][b]=d;return a},getConf:function(a){return a?c[4][a]:c[4]},parseVars:function(a,d){return F(a,d?d:c[3])},objFromCss:function(a){return L(a)},cssFromObj:function(a,c,f){return v(a,c,f)},_conf:T,type:D,exportType:U,messages:u});a.defineConf(T);return a}var D=C({rule:1,
charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,viewport:15}),U=C({css:"css",min:"min",obj:"obj",object:"object",notMDObject:"objNMD",array:"array"}),T=C({styleId:"cssc-style",viewErr:!0,tabLen:2}),w=[{},!0,-1,[],{}],u=[];return S()}();
