/* CSSC.js | @version 1.0b |  m13p4 */
var CSSC=function(){function n(b,a,c){if(c)return Object.prototype.toString.call(b);c=Object.prototype.toString.call(b).replace(/(^\[.+\s|\]$)/g,"");"Number"===c&&(c=Math.floor(b)===b?"integer":"float");return a?c.substr(0,a):c}function A(){if(Object.assign)return Object.assign.apply(null,arguments);var b,a;for(a=1;a<arguments.length;a++)for(b in arguments[a])arguments[0][b]=arguments[a][b];return arguments[0]}function K(b,a){var c;if(Object.defineProperty)for(c in a)Object.defineProperty(b,c,{enumerable:!0,
value:a[c]});else for(c in a)b[c]=a[c]}function D(b){if(Object.freeze)return Object.freeze(b);if(Object.defineProperty){var a={},c;for(c in b)Object.defineProperty(a,c,{enumerable:!0,value:b[c]});b=a}Object.preventExtensions&&Object.preventExtensions(b);return b}function v(b,a){if(!a&&Object.keys)return Object.keys(b);if(a&&Object.values)return Object.values(b);var c=[],d;for(d in b)c.push(a?b[d]:d);return c}function L(b,a,c){var d="S"===n(b,1);if(isFinite(b)){c=c||"px";var e=parseInt(b);b=e==b?a.match(/(^|-)color$/i)||
d&&b.match(/^0x[0-9a-f]+$/i)?"rgb("+[(e&16711680)>>16,(e&65280)>>8,e&255].join()+")":""+b+c:""+Math.floor(100*b)/100+c}else if(d&&-1<b.indexOf(" ")&&(d=b.split(" "),1<d.length)){for(b=0;b<d.length;b++)d[b]=L(d[b],a,c);b=d.join(" ")}return b}function M(b){if(b.match(/^@(namespace|import|charset)/))return b.replace(/(^@(namespace|import|charset)\s*|\s*;\s*$)/g,"");var a=b.replace(/(^.*?{\s*|\s*}\s*$)/g,"");b=a.split(";");var c={};if(""!==a)for(a=0;a<b.length;a++)if(""!==b[a]){var d=b[a].split(":");
c[d[0].trim()]=d.slice(1).join(":").trim()}return c}function x(b,a,c,d,e){var f=Array((parseInt(c)||2)+1).join(" "),h="",g,l=n(b,1);d=d||"";if("S"===l)return b;if("A"===l)for(l=0;l<b.length;l++)h+=x(b[l],a,c,d,!0);else for(g in b){var k=""+b[g];l=n(b[g],1);if("O"===l||"A"===l)if(e&&"A"===l){var m=x(b[g],a,c,d+f,e);""!==m&&(h=a?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n"))}else for("O"===l&&(k=[b[g]]),l=0;l<k.length;l++)"@namespace"===g||"@import"===
g||"@charset"===g?h+=g+" "+k[l]+";"+(a?"":"\n"):(m=x(k[l],a,c,d+f,e),""!==m&&(h=a?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n")));else h="@namespace"===g||"@import"===g||"@charset"===g?h+(g+" "+k+";"+(a?"":"\n")):a?h+(g+":"+k.trim().replace(/\s*,\s*/g,",")+";"):h+((d.length<f.length?f:d)+g+": "+k+";\n")}return h}function N(b){b=b.trim();if("@"!==b.charAt(0))return 1;b=b.substr(1);var a=b.indexOf(" ");0<=a&&(b=b.substr(0,a));a=b;if(0<=b.indexOf("-")){b=
b.split("-");var c;a=b[0];for(c=1;c<b.length;c++)a+=b[c].charAt(0).toUpperCase()+b[c].substr(1)}return a in E?E[a]:-1}function F(b,a){"@"===a.charAt(0)&&"@"===b.charAt(0)&&(a=a.substr(1));a="/"===a.charAt(0)?a.substr(1):","===a.charAt(0)?", "+a.substr(1).trim():" "+a;if(0<=b.indexOf(",")||0<a.indexOf(",")){b=b.split(",");var c,d="",e=a.split(",");if(","!==a.charAt(0))for(c=0;c<b.length;c++)for(a=0;a<e.length;a++)d+=b[c]+e[a]+", ";else for(c=0;c<b.length;c++)d+=b[c]+a+", ";return d.replace(/,+\s*$/,
"")}return b+a}function O(b){var a=b.parentRule?b.parentRule:b.parentStyleSheet,c;for(c=0;c<a.cssRules.length;c++)if(a.cssRules[c]===b){a.deleteRule(c);break}}function G(b,a,c){c||(c=100);a||(a={});b||(b="");for(var d=b.lastIndexOf("$"),e,f=0,h,g,l,k,m,q;0<=d&&f<c;){f++;h=null;k=b.substr(d+1);e=k.search(/[^\w\.]/);e=0>e?b.length:e+d;m=b.substr(d+1,e-d);q=m.split(".");for(g=0;g<q.length;g++)if(!(1>q[g].length)){l=n(h,1);if(0===g&&q[g]in a)h=a[q[g]];else if(null!==h&&l.match(/[OA]/)&&q[g]in h)h=h[q[g]];
else if("S"===l&&q[g].match(/^[0-9]+$/))h=h.charAt(q[g]);else{h="$"+m;break}if("F"===n(h,1)){if("("===b.charAt(e+1)){e++;l=k=e;do l=b.indexOf("(",l+1),e=b.indexOf(")",e+1);while(-1<l&&l<e);0>e&&(e=b.length);k=b.substr(k+1,e-k-1);k=k.trim().split(/\s*,\s*/);h=h.apply(null,k)}else h=h();if("."===b.charAt(e+1))for(e++,l=e,k=b.substr(e+1),e=k.search(/[^\w\.]/),k=k.substr(0,0>e?k.length:e),e=0>e?b.length:e+l,m=b.substr(d+1,e-d),k=k.split("."),l=0;l<k.length;l++)q.push(k[l])}}b=b.substr(0,d)+h+b.substr(e+
1);e="$"+m===h?d:e+(h.length-1);if(0>--e)break;d=b.lastIndexOf("$",e)}return b}function P(b,a,c){for(var d=0;d<a.length;d++)a[d]&&a[d].parentStyleSheet&&a[d].parentStyleSheet.ownerNode&&a[d].parentStyleSheet.ownerNode.id===b[4].style_id&&B(b,a[d],c)}function B(b,a,c,d){var e=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),f=a.type,h=c?c.children:b[0];if(1!==f&&5!==f&&4!==f&&7!==f&&8!==f&&6!==f&&12!==f&&10!==f&&3!==f&&2!==f)console.log("unsuported type: "+f);else return 10===f&&(e="@namespace"),
3===f&&(e="@import"),2===f&&(e="@charset"),a._update=!1,1===f&&(a.style._update={}),b[2]++,c={indexElem:a,selector:e,csscSelector:d?d:e,children:!1,parent:c?c:!1,events:{},obj:{},type:f,p:b[2]},h[e]?d=h[e].content.push(c)-1:(h[e]={type:f,content:[c],events:{}},d=0),4===f||7===f||12===f?(h[e].content[d].children={},P(b,a.cssRules,h[e].content[d])):h[e].content[d].obj=M(a.cssText),c}function r(b,a,c,d,e){var f;if(!e&&!b[1]){if(document.getElementById(b[4].style_id)){for(f=0;10>f;f++)if(!document.getElementById(b[4].style_id+
"-"+f)){b[4].style_id=b[4].style_id+"-"+f;break}if(document.getElementById(b[4].style_id))throw Error("cann not create new element..");}f=document.createElement("style");f.setAttribute("type","text/css");f.setAttribute("id",b[4].style_id);f.appendChild(document.createTextNode(""));document.head.appendChild(f);b[1]=f}f=e?e.indexElem:b[1].sheet;var h=f.cssRules.length,g="";if(c){var l=n(c,1);if("O"===l)for(var k in c)"F"===n(c[k],1)?(d=c[k](),g+=k+":"+d+"; "):g+=k+":"+c[k]+"; ";else if("F"===l)for(k in d=
c(),d)g+=k+":"+d[k]+"; ";else g=c+":"+d+";"}d=a+"{"+g+"}";l=!1;if("@namespace"===a||"@import"===a||"@charset"===a)d=a+" "+c;try{"insertRule"in f?f.insertRule(d,h):"appendRule"in f?f.appendRule(d,h):"addRule"in f&&f.addRule(a,g,h),l=B(b,f.cssRules[h],e,a)}catch(m){c=(e?'"'+e.selector+'" > ':"")+'"'+a+'" -> '+m,b[4].view_err&&console.log(c),w.push(c)}return l?l:B(b,{csscSelector:a,cssText:d,parent:e||!1,type:N(a),placeholder:!0,cssRules:{},style:{}},e,k)}function Q(b,a,c){if(b&&b[a]){var d=c?b[a].content.indexOf(c):
-1;c?0<=d&&(b[a].content.splice(d,1),0>=b[a].content.length&&delete b[a]):delete b[a]}}function y(b,a,c){var d=n(a,1),e="A"===n(b,1)?b[0]:b;if("S"===d)return c?e[a]?e[a].content:[]:t(b,e[a]?e[a].content:[],a);if("R"===d){d=[];for(var f in e)if(f.match(a))for(h=0;h<e[f].content.length;h++)d.push(e[f].content[h]);return c?d:t(b,d,a)}if("A"===d){d=[];var h;for(h=0;h<a.length;h++)if(e[a])for(f=0;f<e[a].content.length;f++)d.push(e[a].content[f]);return c?d:t(b,d,a)}if("N"===d||"U"===d){d=[];for(f in e)for(h=
0;h<e[f].content.length;h++)d.push(e[f].content[h]);return c?d:t(b,d,a)}return null}function z(b,a,c,d){var e=n(a,1);if("R"===e||"U"===e||"N"===e||"A"===e||"S"===e)return y(b,a,c);C(b,a);return d}function C(b,a,c,d){var e,f,h={};d||c||("@charset"in a&&(h["@charset"]=a["@charset"]),"@import"in a&&(h["@import"]=a["@import"]),"@namespace"in a&&(h["@namespace"]=a["@namespace"]),"@font-face"in a&&(h["@font-face"]=a["@font-face"]),0<v(h).length&&C(b,h,c,!0));for(g in a)if(!(g in h)){d="A"===n(a[g],1)?a[g]:
[a[g]];var g=G(g,b[3],b[4].parse_vars_limit);for(e=0;e<d.length;e++)if("@"===g.charAt(0))if("@font-face"===g||"@namespace"===g||"@import"===g||"@charset"===g)r(b,g,d[e],null,c);else{if(g.match(/^@(media|keyframes|supports)/)||c&&(4===c.type||7===c.type||12===c.type)){var l=g;(f=c)&&!g.match(/^@(media|keyframes|supports)/)&&(g=F(c.csscSelector,g),f=c.parent);var k=r(b,g,null,null,f);k&&k.selector===k.csscSelector||(k&&(O(k.indexElem),Q(k.parent?k.parent:b[0],k.selector,k)),f={csscSelector:g,cssText:g+
" {}",parent:f||!1,placeholder:!0,type:N(g),cssRules:{}},k=B(b,f,f.parent,g));C(b,d[e],k);c&&(c.obj[l]||(c.obj[l]=[]),c.obj[l].push(k))}}else n(d[e],1).match(/[Sfi]/)?(f=c?c.children:b[0],f["*"]||r(b,"*",null,null,c),p(b,[f["*"].content[0]],g,d[e])):(k=r(b,g,null,null,c))&&p(b,[k],d[e])}}function p(b,a,c,d,e){if("i"===n(e,1))if(5===a[e].indexElem.type)b[4].view_err&&console.log("@font-face rules are readonly."),w.push("@font-face rules are readonly.");else if(c=G(c,b[3],b[4].parse_vars_limit),a[e].children)p(b,
y(a[e].children,null,!0),c,d);else{var f=n(d,1);if("O"===f||"A"===f){var h="@"===c.charAt(0);f="O"===f?[d]:d;var g,l=F(a[e].selector,c);h&&(l=a[e].parent?F(a[e].parent.selector,c):c);for(g=0;g<f.length;g++)if(d=r(b,l,null,null,h?!1:a[e].parent)){if(h){var k=d;(d=r(b,a[e].selector,null,null,d))||(d=k)}p(b,[d],f[g]);h&&a[e].parent&&(k=a[e].parent,k.obj[c]&&"push"in k.obj[c]||(k.obj[c]=[]),k.obj[c].push(d.parent));a[e].obj[c]&&"push"in a[e].obj[c]||(a[e].obj[c]=[]);a[e].obj[c].push(d)}}else if("F"===
f){h=R(b,[a[e]],c);try{g=d(h),p(b,a,c,g,e),a[e].indexElem.style._update[c]=d}catch(m){b[4].view_err&&console.log(m),w.push(m)}}else b=L(d,c,b[4].parse_unit_default),a[e].indexElem.style[c]=b,a[e].obj[c]=b}else if(e=n(c,1),"O"===e?h=v(c).length:"F"===e&&(l=c()),"A"===e||"F"===e&&"A"===n(l,1))for(c="A"===e?c:l,g=0;g<c.length;g++)if(a.length>g)p(b,[a[g]],c[g]);else break;else for(g=0;g<a.length;g++)if("O"===e&&0<h)for(f in c)p(b,a,f,c[f],g);else if("F"===e){for(f in l)p(b,a,f,l[f],g);a[g].indexElem._update=
c}else p(b,a,c,d,g)}function R(b,a,c,d){if(!c)return u(b,a,"object");var e=[],f="",h;d=!!d;for(h=0;h<a.length;h++){var g="";a[h].obj[c]&&(g=a[h].obj[c],"A"===n(g,1)&&(g=u(b,g,"object")));g&&""!==g||(g=a[h].indexElem.style[c]);g&&""!==g||(g=(g=a[h].indexElem.cssText.match(new RegExp(c+"s*:s*(.+?);")))?g[1].trim():"");g&&(f=g,d&&e.push(f))}return d?e:f}function u(b,a,c,d){var e={},f,h,g,l=c;"obj"===c&&(c="object");if("arr"===c||"css"===c||"min"===c)c="array";d||(d=[]);for(f=0;f<a.length;f++)if(!(0<=
d.indexOf(a[f]))){if(10===a[f].type||3===a[f].type||2===a[f].type)var k=a[f].obj;else for(g in k=A({},a[f].obj),a[f].obj)if("A"===n(a[f].obj[g],1))if("objNMD"===c||"array"===c)k[g]=null,delete k[g];else{k[g]=[];for(h=0;h<a[f].obj[g].length;h++)if(!(0<=d.indexOf(a[f].obj[g][h]))){var m=u(b,[a[f].obj[g][h]],c,d)[a[f].obj[g][h].selector];d.push(a[f].obj[g][h]);!m||0>=v(m).length||(k[g][h]=m)}0===k[g].length?delete k[g]:1===k[g].length&&(k[g]=k[g][0])}a[f].children&&(k=A(u(b,y(a[f].children,null,!0),
c,d),k));1>v(k).length||("array"===c?(e[a[f].p]={},e[a[f].p][a[f].selector]=k):e[a[f].selector]?("A"!==n(e[a[f].selector],1)&&(e[a[f].selector]=[e[a[f].selector]]),e[a[f].selector].push(k)):e[a[f].selector]=k,d.push(a[f]))}if("array"===c)return e=v(e,!0),c===l||"arr"===l?e:x(e,"min"===l,b[4].parse_tab_len);b={};e["@charset"]&&(b["@charset"]=e["@charset"]);e["@import"]&&(b["@import"]=e["@import"]);e["@namespace"]&&(b["@namespace"]=e["@namespace"]);e["@font-face"]&&(b["@font-face"]=e["@font-face"]);
if(m=0<v(b).length)for(f in e)b[f]||(b[f]=e[f]);return m?b:e}function S(b,a){var c,d;for(c=0;c<a.length;c++){if(!1!==a[c].indexElem._update){var e=a[c].indexElem._update();for(d in e)p(b,a,d,e[d],c)}if(a[c].children)S(b,y(a[c].children,null,!0));else if(a[c].indexElem.style)for(d in a[c].indexElem.style._update)p(b,a,d,a[c].indexElem.style._update[d](),c)}}function H(b,a,c,d){var e=!!n(c,1).match(/[NU]/),f,h=[];for(f=0;f<a.length;f++)a[f].children&&H(b,y(a[f].children,null,!0),c,d),e?(O(a[f].indexElem),
Q(a[f].parent?a[f].parent:b[0],a[f].selector,a[f])):(h.push(a[f]),a[f].indexElem.style[c]="",a[f].obj[c]&&("A"===n(a[f].obj[c],1)&&H(b,a[f].obj[c]),delete a[f].obj[c]));d&&(d.e=I(b,h))}function J(b,a,c,d,e){0>c&&(c+=a.length);return a[c]?t(b,[a[c]],d,!1,a[c].parent?a[c].parent:!1):t(b,[],d,!1,e)}function I(b,a){for(var c=[],d=0;d<a.length;d++)a[d].indexElem&&c.push(a[d].indexElem.placeholder?u(b,[a[d]],"obj"):a[d].indexElem);return c}function t(b,a,c,d,e){function f(){if(1>a.length&&!d&&"S"===n(c,
1)){var f,l=[],k,m=e?e:[null];for(k=0;k<m.length;k++)(f=r(b,c,null,null,m[k]))&&l.push(f);a=l;h.e=I(b,a);h.selector=1===a.length?a[0].selector:c}}var h=function(c){var d,e,g=[];f();for(d=0;d<a.length;d++)if(a[d].children){var h=z(a[d].children,c,!0);for(e=0;e<h.length;e++)g.push(h[e])}return t(b,g,c,null,a)};h.e=I(b,a);h.selector=1===a.length?a[0].selector:c;K(h,{set:function(c,d){f();p(b,a,c,d);return h},get:function(c,d){return R(b,a,c,d)},update:function(){S(b,a);return h},"delete":function(c){H(b,
a,c,h);return h},"export":function(c){return u(b,a,c)},parse:function(c){return u(b,a,c?"min":"css")},pos:function(d){return J(b,a,d,c,e)},first:function(){return J(b,a,0,c,e)},last:function(){return J(b,a,-1,c,e)}});return h}function T(b,a,c,d){var e=n(a,1);if("O"===e)A(b,a);else if("S"===e){if("U"===n(c,1))return b[a];b[a]=c}else{if("A"===e){c={};for(d=0;d<a.length;d++)c[a[d]]=b[a[d]];return c}if("U"===e)return b}return d}function U(){var b=[{},!1,0,{},{}],a=function(c){try{return z(b,c,!1,a)}catch(d){b[4].view_err&&
console.log(d),w.push(d)}};K(a,{version:"1.0b",init:function(c){c="length"in c?c:[c];for(var d=0;d<c.length;d++)if("sheet"in c[d]&&(c[d]=c[d].sheet),"cssRules"in c[d])try{P(b,c[d].cssRules,null)}catch(e){b[4].view_err&&console.log('Cannot init CSS from "'+c[d].href+'"'),w.push('Cannot init CSS from "'+c[d].href+'"')}return a},"import":function(c){C(b,c);return a},"export":function(a){return z(b).export(a)},parse:function(a){return z(b).parse(a)},update:function(c){z(b,c).update();return a},"new":function(){return U()},
conf:function(c,d){return T(b[4],c,d,a)},vars:function(c,d){return T(b[3],c,d,a)},parseVars:function(a,d){return G(a,d?A({},b[3],d):b[3],b[4].parse_vars_limit)},objFromCss:function(a){return M(a)},cssFromObj:function(a,b,e){return x(a,b,e)},_conf:V,type:E,type_export:W,messages:w});a.conf(V);return a}var E=D({rule:1,charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,viewport:15}),W=D({css:"css",min:"min",obj:"obj",arr:"arr",
object:"object",notMDObject:"objNMD",array:"array"}),V=D({style_id:"cssc-style",view_err:!0,parse_tab_len:2,parse_unit_default:"px",parse_vars_limit:100}),w=[];return U()}();
