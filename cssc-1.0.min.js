/* CSSC.js | @version 1.0b |  m13p4 */
var CSSC=function(){function n(c,b,a){if(a)return Object.prototype.toString.call(c);a=Object.prototype.toString.call(c).replace(/(^\[.+\s|\]$)/g,"");"Number"===a&&(a=Math.floor(c)===c?"int":"float");return b?a.substr(0,b):a}function B(){if(Object.assign)return Object.assign.apply(null,arguments);var c,b;for(b=1;b<arguments.length;b++)for(c in arguments[b])arguments[0][c]=arguments[b][c];return arguments[0]}function G(c,b){var a;if(Object.defineProperty)for(a in b)Object.defineProperty(c,a,{enumerable:!0,
value:b[a]});else for(a in b)c[a]=b[a]}function C(c){if(Object.freeze)return Object.freeze(c);if(Object.defineProperty){var b={},a;for(a in c)Object.defineProperty(b,a,{enumerable:!0,value:c[a]});c=b}Object.preventExtensions&&Object.preventExtensions(c);return c}function H(c){if(c.match(/^@(namespace|import|charset)/))return c.replace(/(^@(namespace|import|charset)\s*|\s*;\s*$)/g,"");var b=c.replace(/(^.*?{\s*|\s*}\s*$)/g,"");c=b.split(";");var a={};if(""!==b)for(b=0;b<c.length;b++)if(""!==c[b]){var d=
c[b].split(":");a[d[0].trim()]=d.slice(1).join(":").trim()}return a}function w(c,b,a,d,f){var e=Array((parseInt(a)||2)+1).join(" "),h="",g,k=n(c,1);d=d||"";if("S"===k)return c;if("A"===k)for(k=0;k<c.length;k++)h+=w(c[k],b,a,d,!0);else for(g in c){var l=c[g];k=n(c[g],1);if("O"===k||"A"===k)if(f&&"A"===k){var m=w(c[g],b,a,d+e,f);""!==m&&(h=b?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n"))}else for("O"===k&&(l=[c[g]]),k=0;k<l.length;k++)"@namespace"===
g||"@import"===g||"@charset"===g?h+=g+" "+l[k]+";"+(b?"":"\n"):(m=w(l[k],b,a,d+e,f),""!==m&&(h=b?h+(g.replace(/\s*(,|:)\s*/g,"$1")+"{"+m+"}"):h+(d+g.replace(/\s*,\s*/g,",\n"+d)+" {\n"+m+d+"}\n")));else h="@namespace"===g||"@import"===g||"@charset"===g?h+(g+" "+l+";"+(b?"":"\n")):b?h+(g+":"+l.trim().replace(/\s*,\s*/g,",")+";"):h+((d.length<e.length?e:d)+g+": "+l+";\n")}return h}function I(c){c=c.trim();if("@"!==c.charAt(0))return 1;c=c.substr(1);var b=c.indexOf(" ");0<=b&&(c=c.substr(0,b));b=c;if(0<=
c.indexOf("-")){c=c.split("-");var a;b=c[0];for(a=1;a<c.length;a++)b+=c[a].charAt(0).toUpperCase()+c[a].substr(1)}return b in D?D[b]:-1}function E(c,b){"@"===b.charAt(0)&&"@"===c.charAt(0)&&(b=b.substr(1));b="/"===b.charAt(0)?b.substr(1):","===b.charAt(0)?", "+b.substr(1).trim():" "+b;if(0<=c.indexOf(",")||0<b.indexOf(",")){c=c.split(",");var a,d="",f=b.split(",");if(","!==b.charAt(0))for(a=0;a<c.length;a++)for(b=0;b<f.length;b++)d+=c[a]+f[b]+", ";else for(a=0;a<c.length;a++)d+=c[a]+b+", ";return d.replace(/,+\s*$/,
"")}return c+b}function J(c){var b=c.parentRule?c.parentRule:c.parentStyleSheet,a;for(a=0;a<b.cssRules.length;a++)b.cssRules[a]===c&&b.deleteRule(a)}function F(c,b){b?"A"!==n(b,1)&&(b=[b]):b=[{}];c||(c="");for(var a=c.lastIndexOf("$"),d,f=0,e,h,g,k,l,m;0<=a&&100>f;){f++;e=null;k=c.substr(a+1);d=k.search(/[^\w\.]/);d=0>d?c.length:d+a;l=c.substr(a+1,d-a);m=l.split(".");for(h=0;h<m.length;h++)if(!(1>m[h].length)){g=n(e,1);if(0===h)for(g=b.length-1;0<=g;g--){if(m[h]in b[g]){e=b[g][m[h]];break}}else if(null!==
e&&g.match(/[OA]/)&&m[h]in e)e=e[m[h]];else if("S"===g&&m[h].match(/^[0-9]+$/))e=e.charAt(m[h]);else{e="$"+l;break}if("F"===n(e,1)){if("("===c.charAt(d+1)){d++;g=k=d;do g=c.indexOf("(",g+1),d=c.indexOf(")",d+1);while(-1<g&&g<d);0>d&&(d=c.length);k=c.substr(k+1,d-k-1);k=k.trim().split(/\s*,\s*/);e=e.apply(null,k)}else e=e();if("."===c.charAt(d+1))for(d++,g=d,k=c.substr(d+1),d=k.search(/[^\w\.]/),k=k.substr(0,0>d?k.length:d),d=0>d?c.length:d+g,l=c.substr(a+1,d-a),k=k.split("."),g=0;g<k.length;g++)m.push(k[g])}}c=
c.substr(0,a)+e+c.substr(d+1);d="$"+l===e?a:d+(e.length-1);if(0>--d)break;a=c.lastIndexOf("$",d)}return c}function K(c,b,a){for(var d=0;d<b.length;d++)b[d]&&b[d].parentStyleSheet&&b[d].parentStyleSheet.ownerNode&&b[d].parentStyleSheet.ownerNode.id===c[4].styleId&&y(c,b[d],a)}function y(c,b,a,d){var f=b.cssText.substr(0,b.cssText.indexOf("{")).trim(),e=b.type,h=a?a.children:c[0];if(1!==e&&5!==e&&4!==e&&7!==e&&8!==e&&6!==e&&12!==e&&10!==e&&3!==e&&2!==e)console.log("unsuported type: "+e);else return 10===
e&&(f="@namespace"),3===e&&(f="@import"),2===e&&(f="@charset"),b._update=!1,1===e&&(b.style._update={}),c[2]++,c={indexElem:b,selector:f,csscSelector:d?d:f,children:!1,parent:a?a:!1,events:{},obj:{},type:e,p:c[2]},h[f]?(h[f].content[0].indexElem===b&&(console.log('Dublicate "'+f+'": '),console.log(Error().stack+"\n\n")),a=h[f].content.push(c)-1):(h[f]={type:e,content:[c],events:{}},a=0),4===e||7===e||12===e?(h[f].content[a].children={},K(b.cssRules,h[f].content[a])):h[f].content[a].obj=H(b.cssText),
c}function q(c,b,a,d,f){var e;if(!f&&!c[1]){if(document.getElementById(c[4].styleId)){for(e=0;10>e;e++)if(!document.getElementById(c[4].styleId+"-"+e)){c[4].styleId=c[4].styleId+"-"+e;break}if(document.getElementById(c[4].styleId))throw Error("cann not create new element..");}e=document.createElement("style");e.setAttribute("type","text/css");e.setAttribute("id",c[4].styleId);e.appendChild(document.createTextNode(""));document.head.appendChild(e);c[1]=e}e=f?f.indexElem:c[1].sheet;var h=e.cssRules.length,
g="";if(a){var k=n(a,1);if("O"===k)for(var l in a)"F"===n(a[l],1)?(d=a[l](),g+=l+":"+d+"; "):g+=l+":"+a[l]+"; ";else if("F"===k)for(l in d=a(),d)g+=l+":"+d[l]+"; ";else g=a+":"+d+";"}d=b+"{"+g+"}";k=!1;if("@namespace"===b||"@import"===b||"@charset"===b)d=b+" "+a;try{"insertRule"in e?e.insertRule(d,h):"appendRule"in e?e.appendRule(d,h):"addRule"in e&&e.addRule(b,g,h),k=y(c,e.cssRules[h],f,b)}catch(m){a=(f?'"'+f.selector+'" > ':"")+'"'+b+'" -> '+m,c[4].viewErr&&console.log(a),t.push(a)}return k?k:y(c,
{csscSelector:b,cssText:d,parent:f||!1,type:I(b),placeholder:!0,cssRules:{},style:{}},f,l)}function L(c,b,a){if(c&&c[b]){var d=a?c[b].content.indexOf(a):-1;a?0<=d&&(c[b].content.splice(d,1),0>=c[b].content.length&&delete c[b]):delete c[b]}}function u(c,b,a){var d=n(b,1),f="A"===n(c,1)?c[0]:c;if("S"===d)return a?f[b]?f[b].content:[]:r(c,f[b]?f[b]:[],b);if("R"===d){d=[];for(var e in f)if(e.match(b))for(h=0;h<f[e].content.length;h++)d.push(f[e].content[h]);return a?d:r(c,d,b)}if("A"===d){d=[];var h;
for(h=0;h<b.length;h++)if(f[b])for(e=0;e<f[b].content.length;e++)d.push(f[b].content[e]);return a?d:r(c,d,b)}if("N"===d||"U"===d){d=[];for(e in f)for(h=0;h<f[e].content.length;h++)d.push(f[e].content[h]);return a?d:r(c,d,b)}return null}function x(c,b,a){var d=n(b,1);return"S"===d||"R"===d||"A"===d||"N"===d||"U"===d?u(c,b,a):z(c,b)}function z(c,b,a,d){var f,e,h={};d||a||("@charset"in b&&(h["@charset"]=b["@charset"]),"@import"in b&&(h["@import"]=b["@import"]),"@namespace"in b&&(h["@namespace"]=b["@namespace"]),
"@font-face"in b&&(h["@font-face"]=b["@font-face"]),0<Object.keys(h).length&&z(c,h,a,!0));for(g in b)if(!(g in h)){d="A"===n(b[g],1)?b[g]:[b[g]];var g=F(g,c[3]);for(f=0;f<d.length;f++)if("@"===g.charAt(0))if("@font-face"===g||"@namespace"===g||"@import"===g||"@charset"===g)q(c,g,d[f],null,a);else{if(g.match(/^@(media|keyframes|supports)/)||a&&(4===a.type||7===a.type||12===a.type)){var k=g;(e=a)&&!g.match(/^@(media|keyframes|supports)/)&&(g=E(a.csscSelector,g),e=a.parent);var l=q(c,g,null,null,e);
l&&l.selector===l.csscSelector||(l&&(J(l.indexElem),L(l.parent?l.parent:c[0],l.selector,l)),e={csscSelector:g,cssText:g+" {}",parent:e||!1,placeholder:!0,type:I(g),cssRules:{}},l=y(c,e,e.parent,g));z(c,d[f],l);a&&(a.obj[k]||(a.obj[k]=[]),a.obj[k].push(l))}}else(l=q(c,g,null,null,a))&&p(c,[l],d[f])}}function p(c,b,a,d,f){if("i"===n(f,1))if(5===b[f].indexElem.type)c[4].viewErr&&console.log("@font-face rules are readonly."),t.push("@font-face rules are readonly.");else if(a=F(a,c[3]),b[f].children)p(c,
u(b[f].children,null,!0),a,d);else{var e=n(d,1);if("O"===e||"A"===e){var h="@"===a.charAt(0);e="O"===e?[d]:d;var g,k=E(b[f].selector,a);h&&(k=b[f].parent?E(b[f].parent.selector,a):a);for(g=0;g<e.length;g++)if(d=q(c,k,null,null,h?!1:b[f].parent)){if(h){var l=d;(d=q(c,b[f].selector,null,null,d))||(d=l)}p(c,[d],e[g]);h&&b[f].parent&&(l=b[f].parent,l.obj[a]&&"push"in l.obj[a]||(l.obj[a]=[]),l.obj[a].push(d.parent));b[f].obj[a]&&"push"in b[f].obj[a]||(b[f].obj[a]=[]);b[f].obj[a].push(d)}}else if("F"===
e){h=A(c,b,f).get(a);try{g=d(h),p(c,b,a,g,f),b[f].indexElem.style._update[a]=d}catch(m){c[4].viewErr&&console.log(m),t.push(m)}}else{a:if(isFinite(d))c=0===d%1?d+"px":Math.floor(100*d)/100+"px";else{if("S"===n(d,1)&&(c=d.split(" "),0<c.length)){for(d=0;d<c.length;d++)isFinite(c[d])&&(g=c[d],c[d]=0===g%1?g+"px":Math.floor(100*g)/100+"px");c=c.join(" ");break a}c=d}b[f].indexElem.style[a]=c;b[f].obj[a]=c}}else if(f=n(a,1),"O"===f?h=Object.keys(a).length:"F"===f&&(k=a()),"A"===f||"F"===f&&"A"===n(k,
1))for(a="A"===f?a:k,g=0;g<a.length;g++)if(b.length>g)p(c,[b[g]],a[g]);else break;else for(g=0;g<b.length;g++)if("O"===f&&0<h)for(e in a)p(c,b,e,a[e],g);else if("F"===f){for(e in k)p(c,b,e,k[e],g);b[g].indexElem._update=a}else p(c,b,a,d,g)}function v(c,b,a,d){var f={},e,h,g,k=a;"obj"===a&&(a="object");if("css"===a||"min"===a)a="array";d||(d=[]);for(e=0;e<b.length;e++)if(!(0<=d.indexOf(b[e]))){if(10===b[e].type||3===b[e].type||2===b[e].type)var l=b[e].obj;else for(g in l=B({},b[e].obj),b[e].obj)if("A"===
n(b[e].obj[g],1))if("objNMD"===a||"array"===a)l[g]=null,delete l[g];else{l[g]=[];for(h=0;h<b[e].obj[g].length;h++)if(!(0<=d.indexOf(b[e].obj[g][h]))){var m=v(c,[b[e].obj[g][h]],a,d)[b[e].obj[g][h].selector];d.push(b[e].obj[g][h]);!m||0>=Object.keys(m).length||(l[g][h]=m)}0===l[g].length?delete l[g]:1===l[g].length&&(l[g]=l[g][0])}b[e].children&&(l=B(v(c,u(b[e].children,null,!0),a,d),l));0>=Object.keys(l).length||("array"===a?(f[b[e].p]={},f[b[e].p][b[e].selector]=l):f[b[e].selector]?("A"!==n(f[b[e].selector],
1)&&(f[b[e].selector]=[f[b[e].selector]]),f[b[e].selector].push(l)):f[b[e].selector]=l,d.push(b[e]))}if("array"===a)return f=Object.values(f),a===k?f:w(f,"min"===k,c[4].tabLen);c={};f["@charset"]&&(c["@charset"]=f["@charset"]);f["@import"]&&(c["@import"]=f["@import"]);f["@namespace"]&&(c["@namespace"]=f["@namespace"]);f["@font-face"]&&(c["@font-face"]=f["@font-face"]);if(m=0<Object.keys(c).length)for(e in f)c[e]||(c[e]=f[e]);return m?c:f}function A(c,b,a,d,f){0>a&&(a+=b.length);return b[a]?r(c,[b[a]],
d,!1,b[a].parent?b[a].parent:!1):r(c,[],d,!1,f)}function M(c){for(var b=[],a=0;a<c.length;a++)c[a].indexElem&&b.push(c[a].indexElem.placeholder?c[a].obj:c[a].indexElem);return b}function r(c,b,a,d,f){function e(){if(0>=b.length&&!d&&"S"===n(a,1)){var c,e=[],l,m;if(f)for(l=0;l<f.length;l++){if(c=q(a,null,null,f[l]))for(m=0;m<c.content.length;m++)e.push(c.content[m])}else if(c=q(a,null,null))e=c.content;b=e;h.e=M(b);h.selector=1===b.length?b[0].selector:a}}var h=function(a){var d,g,f=[];e();for(d=0;d<
b.length;d++)if(b[d].children){var h=x(b[d].children,a,!0);for(g=0;g<h.length;g++)f.push(h[g])}return r(c,f,a,null,b)};h.e=M(b);h.selector=1===b.length?b[0].selector:a;G(h,{set:function(a,d,f){e();p(c,b,a,d,f);return this},get:function(a,d){var e=b;if(a){var g=[],f="",h;d=!!d;for(h=0;h<e.length;h++){var k="";e[h].obj[a]&&(k=e[h].obj[a],"A"===n(k,1)&&(k=v(c,k,"object")));k&&""!==k||(k=e[h].indexElem.style[a]);k&&""!==k||(k=(k=e[h].indexElem.cssText.match(new RegExp(a+"s*:s*(.+?);")))?k[1].trim():"");
k&&(f=k,d&&g.push(f))}a=d?g:f}else a=v(c,e,"object");return a},update:function(){var a=b,c,d;for(c=0;c<a.length;c++){if(!1!==a[c].indexElem._update){var e=a[c].indexElem._update();for(d in e)p(d,e[d],c)}if(a[c].children)u(a[c].children).update();else if(a[c].indexElem.style)for(d in a[c].indexElem.style._update)p(d,a[c].indexElem.style._update[d](),c)}return this},"delete":function(a){var d=b,e;if(n(a,1).match(/[NU]/))for(e=0;e<d.length;e++)d[e].children&&u(d[e].children).delete(a),J(d[e].indexElem),
L(d[e].parent?d[e].parent:c,d[e].selector,d[e]);else for(e=0;e<d.length;e++)d[e].indexElem.style[a]="",d[e].children&&u(d[e].children).delete(a);return this},"export":function(a){return v(c,b,a)},parse:function(a){return v(c,b,a?"min":"css")},pos:function(d){return A(c,b,d,a,f)},first:function(){return A(c,b,0,a,f)},last:function(){return A(c,b,-1,a,f)}});return h}function N(){var c=[{},!1,0,[],{}],b=function(a){try{return x(c,a)}catch(d){c[4].viewErr&&console.log(d),t.push(d)}};G(b,{version:"1.0b",
init:function(a){a="length"in a?a:[a];for(var b=0;b<a.length;b++)if("sheet"in a[b]&&(a[b]=a[b].sheet),"cssRules"in a[b]){var f=(a[b].ownerNode.getAttribute("data-cssc-ignore")||"").toLowerCase();if("true"!==f&&"1"!==f)try{K(c,a[b].cssRules,null)}catch(e){c[4].viewErr&&console.log('Cannot init CSS from "'+a[b].href+'"'),t.push('Cannot init CSS from "'+a[b].href+'"')}}},"import":function(a){return z(c,a)},"export":function(a){return x(c).export(a)},parse:function(a){return x(c).parse(a)},update:function(a){return x(c,
a).update()},"new":function(){return N()},defineVars:function(a){c[3]=[a];return this},addVars:function(a){c[3].push(a);return this},getVars:function(){return c[3]},defineConf:function(a){c[4]=B(c[4],a);return this},setConf:function(a,b){c[4][a]=b;return this},getConf:function(a){return a?c[4][a]:c[4]},parseVars:function(a,b){return F(a,b?b:c[3])},objFromCss:function(a){return H(a)},cssFromObj:function(a,b,c){return w(a,b,c)},_conf:O,type:D,exportType:P,messages:t,index:c});b.defineConf(O);return b}
var D=C({rule:1,charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,viewport:15}),P=C({css:"css",min:"min",obj:"obj",object:"object",notMDObject:"objNMD",array:"array"}),O=C({styleId:"cssc-style",viewErr:!0,tabLen:2}),t=[];return N()}();
