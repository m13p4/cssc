/* CSSC.js | @version 1.0b |  m13p4 */
var CSSC=function(){function w(b,a){a.view_err&&console.log(b);N.push(b)}function m(b){var a=Object.prototype.toString.call(b).split(/ |\]/)[1];"Number"===a&&(a=Math.floor(b)===b?"Integer":"Float");return Z[a]||a}function G(b,a){for(var c in a)aa(b,c,{enumerable:!0,value:a[c]})}function O(b,a,c){var d=m(b),e=5===d,f=e&&b.match(/^0x[0-9a-f\.\+]+$/i);if(isFinite(b)||f){c=(c||"px")+"";var g=b;f?(d=b.search(/\.|\+/),0>d?g=parseInt(b):(e=b.substr(d+1),g=parseInt(b.substr(0,d))+("+"===b.charAt(d)?parseFloat(e):
parseInt(e,16)/Math.pow(16,e.length))),d=m(g)):e&&(g=parseFloat(b),d=m(g));f||a.match(/(^|-)color$/i)?(b=g,e=0,4===d&&(b=Math.floor(g),e=g-b),b=[(b&16711680)>>16,(b&65280)>>8,b&255].join(", "),b=0<e?"rgba("+b+", "+Math.floor(100*e)/100+")":"rgb("+b+")"):b=3===d?g+c:Math.floor(100*g)/100+c}else if(e&&-1<b.indexOf(" ")){b=b.split(" ");for(d=0;d<b.length;d++)b[d]=O(b[d],a,c);b=b.join(" ")}else e&&"!"===b.charAt(b.length-1)&&(b=b.substr(0,b.length-1));return b}function P(b){if(/^@(namespace|import|charset)/.test(b))return b.replace(/(^@(namespace|import|charset)\s*|\s*;\s*$)/g,
"");var a=b.replace(/(^.*?{\s*|\s*}\s*$)/g,"");b=a.split(";");var c={};if(""!==a)for(a=0;a<b.length;a++)if(""!==b[a]){var d=b[a].split(":");c[d[0].trim()]=d.slice(1).join(":").trim()}return c}function y(b,a,c,d,e){var f=Array((parseInt(c)||2)+1).join(" "),g="",h,l=m(b);d=d||"";if(5===l)return b;if(7===l)for(l=0;l<b.length;l++)g+=y(b[l],a,c,d,!0);else for(h in b){var k=""+b[h];l=m(b[h]);if(7===l||8===l)if(e&&7===l){var n=y(b[h],a,c,d+f,e);""!==n&&(g=a?g+(h.replace(/\s*(,|:)\s*/g,"$1")+"{"+n+"}"):g+
(d+h.replace(/\s*,\s*/g,",\n"+d)+" {\n"+n+d+"}\n"))}else for(8===l&&(k=[b[h]]),l=0;l<k.length;l++)-1<x.indexOf(h)?g+=h+" "+k[l]+";"+(a?"":"\n"):(n=y(k[l],a,c,d+f,e),""!==n&&(g=a?g+(h.replace(/\s*(,|:)\s*/g,"$1")+"{"+n+"}"):g+(d+h.replace(/\s*,\s*/g,",\n"+d)+" {\n"+n+d+"}\n")));else g=-1<x.indexOf(h)?g+(h+" "+k+";"+(a?"":"\n")):a?g+(h+":"+k.trim().replace(/\s*,\s*/g,",")+";"):g+((d.length<f.length?f:d)+h+": "+k+";\n")}return g}function Q(b){b=b.trim();if("@"!==b.charAt(0))return 1;b=b.substr(1);var a=
b.indexOf(" ");-1<a&&(b=b.substr(0,a));if(-1<b.indexOf("-")){a=b.split("-");var c;b=a[0];for(c=1;c<a.length;c++)b+=a[c].charAt(0).toUpperCase()+a[c].substr(1)}return R[b]||-1}function H(b,a){"@"===a.charAt(0)&&"@"===b.charAt(0)&&(a=a.substr(1));a="/"===a.charAt(0)?a.substr(1):","===a.charAt(0)?", "+a.substr(1).trim():" "+a;if(0<=b.indexOf(",")||0<a.indexOf(",")){b=b.split(",");var c,d="",e=a.split(",");if(","!==a.charAt(0))for(c=0;c<b.length;c++)for(a=0;a<e.length;a++)d+=b[c]+e[a]+", ";else for(c=
0;c<b.length;c++)d+=b[c]+a+", ";return d.replace(/,+\s*$/,"")}return b+a}function S(b){var a=b.parentRule?b.parentRule:b.parentStyleSheet,c;for(c=0;c<a.cssRules.length;c++)if(a.cssRules[c]===b){a.deleteRule(c);break}}function z(b,a,c){c||(c=100);a||(a={});b||(b="");for(var d=b.lastIndexOf("$"),e,f=0,g,h,l,k,n,q;0<=d&&f<c;){f++;g=null;k=b.substr(d+1);e=k.search(/[^\w\.]/);e=0>e?b.length:e+d;n=b.substr(d+1,e-d);q=n.split(".");for(h=0;h<q.length;h++)if(!(1>q[h].length)){l=m(g);if(0===h&&q[h]in a)g=a[q[h]];
else if((7===l||8===l)&&q[h]in g)g=g[q[h]];else if(5===l&&q[h].match(/^[0-9]+$/))g=g.charAt(q[h]);else{g="$"+n;break}if(9===m(g)){if("("===b.charAt(e+1)){e++;l=k=e;do l=b.indexOf("(",l+1),e=b.indexOf(")",e+1);while(-1<l&&l<e);0>e&&(e=b.length);k=b.substr(k+1,e-k-1);k=k.trim().split(/\s*,\s*/);g=g.apply(null,k)}else g=g();if("."===b.charAt(e+1))for(e++,l=e,k=b.substr(e+1),e=k.search(/[^\w\.]/),k=k.substr(0,0>e?k.length:e),e=0>e?b.length:e+l,n=b.substr(d+1,e-d),k=k.split("."),l=0;l<k.length;l++)q.push(k[l])}}b=
b.substr(0,d)+g+b.substr(e+1);e="$"+n===g?d:e+(g.length-1);if(0>--e)break;d=b.lastIndexOf("$",e)}return b}function T(b,a,c){for(var d=0;d<a.length;d++)a[d]&&a[d].parentStyleSheet&&a[d].parentStyleSheet.ownerNode&&a[d].parentStyleSheet.ownerNode.id===b[4].style_id&&D(b,a[d],c)}function D(b,a,c,d){var e=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),f=a.type,g=c?c.children:b[0];if(1!==f&&5!==f&&4!==f&&7!==f&&8!==f&&6!==f&&12!==f&&10!==f&&3!==f&&2!==f)w("unsuported type: "+f,b[4]);else return 10===
f&&(e=x[2]),3===f&&(e=x[1]),2===f&&(e=x[0]),c={indexElem:a,selector:e,csscSelector:d?d:e,children:!1,parent:c?c:!1,obj:{},type:f,p:b[2]++,uo:!1,up:{}},g[e]?d=g[e].content.push(c)-1:(g[e]={type:f,content:[c],events:{}},d=0),4===f||7===f||12===f?(g[e].content[d].children={},T(b,a.cssRules,g[e].content[d])):g[e].content[d].obj=P(a.cssText),c}function t(b,a,c,d,e){if(!e&&!b[1]){var f=b[4].style_id;if(document.getElementById(f)){for(var g=0;10>g;g++)if(!document.getElementById(f+"-"+g)){f=f+"-"+g;break}if(document.getElementById(f))throw Error("cann not create new element..");
}g=document.createElement("style");g.setAttribute("type","text/css");g.setAttribute("id",f);g.appendChild(document.createTextNode(""));document.head.appendChild(g);b[1]=g;b[4].style_id=f}f=e?e.indexElem:b[1].sheet;g=f.cssRules.length;var h="";if(c){var l=m(c);if(8===l)for(var k in c)9===m(c[k])?(d=c[k](),h+=k+":"+d+"; "):h+=k+":"+c[k]+"; ";else if(9===l)for(k in d=c(),d)h+=k+":"+d[k]+"; ";else h=c+":"+d+";"}d=a+"{"+h+"}";l=!1;-1<x.indexOf(a)&&(d=a+" "+c);try{"insertRule"in f?f.insertRule(d,g):"appendRule"in
f?f.appendRule(d,g):"addRule"in f&&f.addRule(a,h,g),l=D(b,f.cssRules[g],e,a)}catch(n){w((e?'"'+e.selector+'" > ':"")+'"'+a+'" -> '+n,b[4])}return l?l:D(b,{csscSelector:a,cssText:d,parent:e||!1,type:Q(a),placeholder:!0,cssRules:{},style:{}},e,k)}function U(b,a,c){if(b&&b[a]){var d=c?b[a].content.indexOf(c):-1;c?0<=d&&(b[a].content.splice(d,1),0>=b[a].content.length&&delete b[a]):delete b[a]}}function A(b,a,c){var d=m(a),e=7===m(b)?b[0]:b;if(5===d)return a=z(a,b[3],b[4].parse_vars_limit),c?e[a]?e[a].content:
[]:u(b,e[a]?e[a].content:[],a);if(6===d){d=[];for(var f in e)if(f.match(a))for(g=0;g<e[f].content.length;g++)d.push(e[f].content[g]);return c?d:u(b,d,a)}if(7===d){d=[];var g;for(g=0;g<a.length;g++){var h=z(a[g],b[3],b[4].parse_vars_limit);if(e[h])for(f=0;f<e[h].content.length;f++)d.push(e[h].content[f])}return c?d:u(b,d,a)}if(1===d||2===d){d=[];for(f in e)for(g=0;g<e[f].content.length;g++)d.push(e[f].content[g]);return c?d:u(b,d,a)}}function B(b,a,c,d){var e=m(a);if(5===e||6===e||7===e||1===e||2===
e)return A(b,a,c);E(b,a);return d}function E(b,a,c,d){var e,f,g={};if(!d&&!c){for(e=0;e<r.length;e++)r[e]in a&&(g[r[e]]=a[r[e]]);0<I(g).length&&E(b,g,c,!0)}for(h in a)if(!(h in g)){d=7===m(a[h])?a[h]:[a[h]];var h=z(h,b[3],b[4].parse_vars_limit);for(e=0;e<d.length;e++)if("@"===h.charAt(0))if(-1<r.indexOf(h))t(b,h,d[e],null,c);else{if(h.match(/^@(media|keyframes|supports)/)||c&&(4===c.type||7===c.type||12===c.type)){var l=h;(f=c)&&!h.match(/^@(media|keyframes|supports)/)&&(h=H(c.csscSelector,h),f=c.parent);
var k=t(b,h,null,null,f);k&&k.selector===k.csscSelector||(k&&(S(k.indexElem),U(k.parent?k.parent:b[0],k.selector,k)),f={csscSelector:h,cssText:h+" {}",parent:f||!1,placeholder:!0,type:Q(h),cssRules:{}},k=D(b,f,f.parent,h));E(b,d[e],k);c&&(c.obj[l]||(c.obj[l]=[]),c.obj[l].push(k))}}else-1<[5,4,3].indexOf(m(d[e]))?(f=c?c.children:b[0],f["*"]||t(b,"*",null,null,c),p(b,[f["*"].content[0]],h,d[e])):(k=t(b,h,null,null,c))&&p(b,[k],d[e])}}function p(b,a,c,d,e){if(3===m(e))if(5===a[e].indexElem.type)w("@font-face rules are readonly.",
b[4]);else if(c=z(c,b[3],b[4].parse_vars_limit),a[e].children)p(b,A(a[e].children,null,!0),c,d);else{var f=m(d);if(8===f||7===f){var g="@"===c.charAt(0),h=8===f?[d]:d,l=H(a[e].selector,c);g&&(l=a[e].parent?H(a[e].parent.selector,c):c);for(f=0;f<h.length;f++)if(d=t(b,l,null,null,g?!1:a[e].parent)){if(g){var k=d;(d=t(b,a[e].selector,null,null,d))||(d=k)}p(b,[d],h[f]);g&&a[e].parent&&(k=a[e].parent,k.obj[c]&&"push"in k.obj[c]||(k.obj[c]=[]),k.obj[c].push(d.parent));a[e].obj[c]&&"push"in a[e].obj[c]||
(a[e].obj[c]=[]);a[e].obj[c].push(d)}}else if(9===f)try{h=d(c,C(b,[a[e]],c)),p(b,a,c,h,e),a[e].up[c]=d}catch(n){w(n,b[4])}else b=O(d,c,b[4].parse_unit_default),a[e].indexElem.style[c]=b,a[e].obj[c]=b}else if(h=m(c),7===h)for(f=0;f<c.length;f++)if(a.length>f)p(b,[a[f]],c[f]);else break;else for(f=0;f<a.length;f++)if(8===h)for(g in c)p(b,a,g,c[g],f);else if(9===h){e=c(a[f].selector,C(b,[a[f]])[a[f].selector]);for(g in e)p(b,a,g,e[g],f);a[f].uo=c}else p(b,a,c,d,f)}function C(b,a,c,d){if(!c)return v(b,
a,3);var e=[],f="",g;for(g=0;g<a.length;g++){var h="";a[g].obj[c]&&(h=a[g].obj[c],7===m(h)&&(h=v(b,h,3)));h&&""!==h||(h=a[g].indexElem.style[c]);h&&""!==h||(h=(h=a[g].indexElem.cssText.match(new RegExp(c+"s*:s*(.+?);")))?h[1].trim():"");h&&(f=h,d&&e.push(f))}return d?e:f}function v(b,a,c,d){3!==m(c)&&(c=ba[c]||3);var e={},f,g,h,l=c;if(1===c||2===c)c=4;d||(d=[]);for(f=0;f<a.length;f++)if(!(0<=d.indexOf(a[f]))){if(10===a[f].type||3===a[f].type||2===a[f].type)var k=a[f].obj;else for(h in k=F({},a[f].obj),
a[f].obj)if(7===m(a[f].obj[h]))if(5===c||4===c)k[h]=null,delete k[h];else{k[h]=[];for(g=0;g<a[f].obj[h].length;g++)if(!(0<=d.indexOf(a[f].obj[h][g]))){var n=v(b,[a[f].obj[h][g]],c,d)[a[f].obj[h][g].selector];d.push(a[f].obj[h][g]);!n||0>=I(n).length||(k[h][g]=n)}0===k[h].length?delete k[h]:1===k[h].length&&(k[h]=k[h][0])}a[f].children&&(k=F(v(b,A(a[f].children,null,!0),c,d),k));1>I(k).length||(4===c?(e[a[f].p]={},e[a[f].p][a[f].selector]=k):e[a[f].selector]?(7!==m(e[a[f].selector])&&(e[a[f].selector]=
[e[a[f].selector]]),e[a[f].selector].push(k)):e[a[f].selector]=k,d.push(a[f]))}if(4===c)return e=ca(e),c===l?e:y(e,2===l,b[4].parse_tab_len);b={};n=!1;for(f=0;f<r.length;f++)e[r[f]]&&(b[r[f]]=e[r[f]],n=!0);if(n)for(f in e)b[f]||(b[f]=e[f]);return n?b:e}function V(b,a){var c,d;for(c=0;c<a.length;c++){if(!1!==a[c].uo){var e=a[c].uo(a[c].selector,C(b,[a[c]])[a[c].selector]);for(d in e)p(b,a,d,e[d],c)}if(a[c].children)V(b,A(a[c].children,null,!0));else for(d in a[c].up)p(b,a,d,a[c].up[d](d,C(b,[a[c]],
d)),c)}}function J(b,a,c,d){var e=-1<[1,2].indexOf(m(c)),f,g=[];for(f=0;f<a.length;f++)a[f].children&&J(b,A(a[f].children,null,!0),c,d),e?(S(a[f].indexElem),U(a[f].parent?a[f].parent:b[0],a[f].selector,a[f])):(g.push(a[f]),a[f].indexElem.style[c]="",a[f].obj[c]&&(7===m(a[f].obj[c])&&J(b,a[f].obj[c]),delete a[f].obj[c]));d&&(d.e=K(b,g))}function L(b,a,c,d,e){0>c&&(c+=a.length);return a[c]?u(b,[a[c]],d,!1,a[c].parent?a[c].parent:!1):u(b,[],d,!1,e)}function K(b,a){for(var c=[],d=0;d<a.length;d++)a[d].indexElem&&
c.push(a[d].indexElem.placeholder?v(b,[a[d]],3):a[d].indexElem);return c}function u(b,a,c,d,e){function f(){if(1>a.length&&!d&&5===m(c)){var f,l=[],k,n=e?e:[null];for(k=0;k<n.length;k++)(f=t(b,c,null,null,n[k]))&&l.push(f);a=l;g.e=K(b,a);g.selector=1===a.length?a[0].selector:c}}var g=function(c){var d,e,g=[];f();for(d=0;d<a.length;d++)if(a[d].children){var h=B(a[d].children,c,!0);for(e=0;e<h.length;e++)g.push(h[e])}return u(b,g,c,null,a)};g.e=K(b,a);g.selector=1===a.length?a[0].selector:c;G(g,{set:function(c,
d){f();p(b,a,c,d);return g},get:function(c,d){return C(b,a,c,d)},update:function(){V(b,a);return g},"delete":function(c){J(b,a,c,g);return g},"export":function(c){return v(b,a,c)},parse:function(c){return v(b,a,c?2:1)},pos:function(d){return L(b,a,d,c,e)},first:function(){return L(b,a,0,c,e)},last:function(){return L(b,a,-1,c,e)}});return g}function W(b,a,c,d){var e=m(a);if(8===e)F(b,a);else if(5===e){if(2===m(c))return b[a];b[a]=c}else{if(7===e){c={};for(d=0;d<a.length;d++)c[a[d]]=b[a[d]];return c}if(2===
e)return b}return d}function X(){var b=[{},!1,0,{},{}],a=function(c){try{return B(b,c,!1,a)}catch(d){w(d,b[4])}};G(a,{version:"1.0b",init:function(c){c="length"in c?c:[c];for(var d=0;d<c.length;d++)if("sheet"in c[d]&&(c[d]=c[d].sheet),"cssRules"in c[d])try{T(b,c[d].cssRules,null)}catch(e){w('Cannot init CSS from "'+c[d].href+'"',b[4])}return a},"import":function(c){E(b,c);return a},"export":function(a){return B(b).export(a)},parse:function(a){return B(b).parse(a)},update:function(c){B(b,c).update();
return a},"new":function(){return X()},conf:function(c,d){return W(b[4],c,d,a)},vars:function(c,d){return W(b[3],c,d,a)},parseVars:function(a,d){return z(a,d?F({},b[3],d):b[3],b[4].parse_vars_limit)},objFromCss:function(a){return P(a)},cssFromObj:function(a,b,e){return y(a,b,e)},_conf:Y,type:R,type_export:da,messages:N});a.conf(Y);return a}var r=["@charset","@import","@namespace","@font-face"],x=r.slice(0,3),N=[],Z={Null:1,Undefined:2,Integer:3,Float:4,String:5,RegExp:6,Array:7,Object:8,Function:9},
F=9===m(Object.assign)?Object.assign:function(){var b,a,c=arguments;for(a=1;a<c.length;a++)for(b in c[a])c[0][b]=c[a][b];return c[0]},aa=9===m(Object.defineProperty)?Object.defineProperty:function(b,a,c){b[a]=c.value},ea=9===m(Object.preventExtensions),M=9===m(Object.freeze)?Object.freeze:function(b){var a={};G(a,b);b=a;ea&&Object.preventExtensions(b);return b},I=9===m(Object.keys)?Object.keys:function(b){var a=[],c;for(c in b)a.push(c);return a},ca=9===m(Object.values)?Object.values:function(b){var a=
[],c;for(c in b)a.push(b[c]);return a},R=M({rule:1,charset:2,"import":3,media:4,fontFace:5,page:6,keyframes:7,keyframe:8,namespace:10,counterStyle:11,supports:12,fontFeatureValues:14,viewport:15}),ba={css:1,min:2,obj:3,object:3,arr:4,array:4,objNMD:5},da=M({css:"css",min:"min",obj:"obj",arr:"arr",object:"object",notMDObject:"objNMD",array:"array"}),Y=M({style_id:"cssc-style",view_err:!0,parse_tab_len:2,parse_unit_default:"px",parse_vars_limit:100});return X()}();
