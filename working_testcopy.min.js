/**
 * CSSController - Dynamic CSS Controller. 
 * |-> CSSC        A way to manage style sheets.
 * 
 * @version 0.12a
 * 
 * @author Pavel
 * @copyright Pavel Meliantchenkov
 */
var CSSC=CSSController=function(){var q,l="cssc-container",A=function(u,C,D,v){var h={},r=!1,x=function(){r||(w(u),r=!0,cssc_index=h)},w=function(a){if("cssRules"in a)y(a.cssRules,a);else if("length"in a)for(var m=0;m<a.length;m++)y(a[m].cssRules,a[m])},y=function(a,m){for(var c=0;c<a.length;c++)a[c].parentStyleSheet.ownerNode.id!==l&&z(a[c],m)},z=function(a,m){var c=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),f=CSSC.typeRule,b=a,k;0<=c.indexOf("-webkit-")&&(c=c.replace("-webkit-",""));0===
c.indexOf("@media ")?f=CSSC.typeCondition:0===c.indexOf("@keyframes ")?f=CSSC.typeKeyFrames:0===c.indexOf("@import ")&&(f=CSSC.typeImport);f===CSSC.typeImport&&(b=null);f!==CSSC.typeRule&&(b=A(a,m,!0,f));k={indexElem:b,updatableClass:!1,updatablePropertys:{},events:{}};h[c]?(h[c].content[0].indexElem===b&&(console.log('Dublicate "'+c+'": '),console.log(Error().stack+"\n\n")),h[c].content.push(k)):h[c]={type:f,content:[k],events:{}};return h[c]},t=function(a){r||x();return h[a]?h[a]:null},p=function(a,
b,c){var f;if(v===CSSC.typeCondition||v===CSSC.typeKeyFrames)f=u;else{if(!q){if(document.getElementById(l)){for(f=0;10>f;f++)if(!document.getElementById(l+"-"+f)){l=l+"-"+f;break}if(document.getElementById(l))throw Error("cann not create new element..");}f=document.createElement("style");f.setAttribute("type","text/css");f.setAttribute("id",l);f.appendChild(document.createTextNode(""));document.head.appendChild(f);q=f}f=q.sheet}var h=f.cssRules.length,k="";if(b)if("[object Object]"===Object.prototype.toString.call(b))for(var e in b)k+=
e+":"+b[e]+"; ";else k=b+":"+c+";";"insertRule"in f?f.insertRule(a+"{"+k+"}",h):"appendRule"in f?f.appendRule(a+"{"+k+"}",h):"addRule"in f&&f.addRule(a,k,h);return z(f.cssRules[h],C)},B={parseValue:function(a){return isFinite(a)?0===a%1?a+"px":Math.floor(100*a)/100+"px":a}},n=function(a,b){var c=a.content,f=function(e,g,b){if(a.events[e])for(var d=0;d<a.events[e].length;d++)a.events[e][d].call(g,b)},n=function(e){return{singleSet:function(g,a,d,b){d||(d=0);0===d&&0<e.length&&(d=e.length-1);"[object Function]"===
Object.prototype.toString.call(a)?(e[d].indexElem.style[g]=B.parseValue(a(e[d].indexElem.style[g])),b||(e[d].updatablePropertys[g]=a)):(e[d].indexElem.style[g]=B.parseValue(a),!b&&e[d].updatablePropertys[g]&&delete e[d].updatablePropertys[g]);return this},set:function(g,a){if(0<e.length)if(f(CSSC.eventBeforeChange,g,a),f(CSSC.eventBeforeSet,g,a),"[object Object]"===Object.prototype.toString.call(g)&&0<Object.keys(g).length)for(var d=0;d<e.length;d++){for(var c in g)this.singleSet(c,g[c],d);e[d].updatableClass&&
(e[d].updatableClass=!1)}else if("[object Function]"===Object.prototype.toString.call(g))for(var h,d=0;d<e.length;d++){h=g();for(c in h)this.singleSet(c,h[c],d,!0);e[d].updatableClass=g}else{if("[object String]"===Object.prototype.toString.call(g)&&"[object String]"===Object.prototype.toString.call(a))for(d=0;d<e.length;d++)this.singleSet(g,a,d),e[d].updatableClass&&(e[d].updatableClass=!1)}else f(CSSC.eventBeforeCreate,g,a),p(b,g,a),e=t(b),f(CSSC.eventCreate,g,a);f(CSSC.eventChange,g,a);f(CSSC.eventSet,
g,a);return this},get:function(g,a){for(var d="",b=0;b<e.length;b++)for(var c=0;c<e[b].indexElem.style.length;c++)if(e[b].indexElem.style[c]===g){d=e[b].indexElem.style[g];break}return d},"delete":function(g){f(CSSC.eventBeforeChange,g,null);f(CSSC.eventBeforeDelete,g,null);if("[object Array]"===Object.prototype.toString.call(g))for(var a=0;a<g.length;a++)for(var d=0;d<e.length;d++)e[d].indexElem.style[g[a]]="";else if("[object Object]"===Object.prototype.toString.call(g))for(a in g)for(d=0;d<e.length;d++)e[d].indexElem.style[a]=
"";else for(d=0;d<e.length;d++)e[d].indexElem.style[g]="";f(CSSC.eventChange,g,null);f(CSSC.eventDelete,g,null);return this},destroy:function(){f(CSSC.eventBeforeDestroy,null,null);for(var a=0;a<e.length;a++)e[a].indexElem.parentStyleSheet.deleteRule(e[a]),h[b]&&delete h[b];f(CSSC.eventDestroy,null,null)},event:function(g,e){var d={type:function(){return g},call:e,index:null,destroy:function(){}};a.events[g]?a.events[g].push(d):a.events[g]=[d];d.index=function(){return a.events[g].length-1};return d},
elems:e,pos:function(a){return 0<=a&&a<e.length?n([e[a]]):null},first:function(){return this.pos(0)},last:function(){return this.pos(e.length-1)},type:a.type,merge:function(a){if(!e||0>=e.length)return this;var c;null===a&&(a=CSSC.conf.defaultMergeType);if(a===CSSC.mergeToFirst)c=e[0];else if(a===CSSC.mergeToLast)c=e[e.length-1];else if(a===CSSC.mergeToOwnFirst||a===CSSC.mergeToOwnLast){for(var d=0;d<e.length&&(elem[d].indexElem.parentStyleSheet.ownerNode.id!==l||(c=elem[d],a!==CSSC.mergeToOwnFirst));d++);
c||(a=p(b,null,null),a.content[a.content.length-1].parentStyleSheet.ownerNode.id===l&&(c=a.content[a.content.length-1]))}if(c){for(d=0;d<e.length;d++);e=[c]}return this},update:function(){for(var a,c=0;c<e.length;c++){if(e[c].updatableClass){a=e[c].updatableClass();for(var d in a)this.singleSet(d,a[d],c,!0)}for(d in e[c].updatablePropertys)this.singleSet(d,e[c].updatablePropertys[d],c,!1)}}}},k=function(a,b){return c[c.length-1](a,b)};k.elems=c;k.type=a.type;k.pos=function(a,b,f){return b?c[a].indexElem(b,
f):c[a].indexElem};k.first=function(a,c){return this.pos(0,a,c)};k.last=function(a,b){return this.pos(c.length-1,a,b)};k.update=function(){for(var a=0;a<c.length;a++)c[a].indexElem.update()};return a.type!==CSSC.typeRule?k:n(c)},b=function(a,h){if("string"===typeof a){var c=null;h||(c=t(a));null===c&&(c=p(a,null,null));return n(c,a)}b.imp(a)};b.append=function(a){w(a)};b.imp=function(a){var b,c,f;for(f in a)b=a[f],c=p(f,null,null),c=n(c,f),c.type!==CSSC.typeRule?c.last().imp(b):c.set(b)};b.exp=function(a){};
b.animate=function(a,b){};b.keyframes=b.animate;b.update=function(a){var b;if(a)b=n(t(a),a),b.update();else for(var c in h)b=n(h[c],a),b.update()};b.typeRule=0;b.typeCondition=1;b.typeKeyFrames=2;b.typeImport=3;b.eventBeforeChange="beforechange";b.eventChange="change";b.eventBeforeSet="beforeset";b.eventSet="set";b.eventBeforeCreate="beforecreate";b.eventCreate="create";b.eventBeforeDelete="beforedelete";b.eventDelete="delete";b.eventBeforeDestroy="beforedestroy";b.eventDestroy="destroy";b.mergeToLast=
0;b.mergeToFirst=1;b.mergeToOwnLast=2;b.mergeToOwnFirst=3;b.conf={get:function(a){},set:function(a,b){},reset:function(a){},defaultMergeType:b.mergeToLast,dontTouchAllreadyLoadedCss:!1};b.conf._default=Object.assign({},b.conf);D?x():window.addEventListener("load",function(){});return b};return A(document.styleSheets,null,!1,null)}();
