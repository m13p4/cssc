/**
 * CSSController - Dynamic CSS Controller. 
 * |-> CSSC        A way to manage style sheets.
 * 
 * @version 0.10a
 *
 * @author Pavel
 * @copyright Pavel Meliantchenkov
 */
var CSSC=function(){var q,m="cssc-container",A=function(u,B,C,v){var h={},r=!1,x=function(){r||(w(u),r=!0,cssc_index=h)},w=function(a){if("cssRules"in a)y(a.cssRules,a);else if("length"in a)for(var l=0;l<a.length;l++)y(a[l].cssRules,a[l])},y=function(a,l){for(var c=0;c<a.length;c++)a[c].parentStyleSheet.ownerNode.id!==m&&z(a[c],l)},z=function(a,l){var c=a.cssText.substr(0,a.cssText.indexOf("{")).trim(),e=CSSC.typeRule,b=a,k;0===c.indexOf("@media ")?e=CSSC.typeCondition:0===c.indexOf("@keyframes ")&&
(e=CSSC.typeKeyFrames);e!==CSSC.typeRule&&(b=new A(a,l,!0,e));k={indexElem:b,updatableClass:!1,updatablePropertys:{}};h[c]?(h[c].content[0].indexElem===b&&(console.log('Dublicate "'+c+'": '),console.log(Error().stack+"\n\n")),h[c].content.push(k)):h[c]={type:e,content:[k],events:{}};return h[c]},t=function(a){r||x();return h[a]?h[a]:null},p=function(a,b,c){var e;if(v===CSSC.typeCondition||v===CSSC.typeKeyFrames)e=u;else{if(!q){if(document.getElementById(m)){for(e=0;10>e;e++)if(!document.getElementById(m+
"-"+e)){m=m+"-"+e;break}if(document.getElementById(m))throw Error("cann not create new element..");}e=document.createElement("style");e.setAttribute("type","text/css");e.setAttribute("id",m);e.appendChild(document.createTextNode(""));document.head.appendChild(e);q=e}e=q.sheet}var h=e.cssRules.length,k="";if(b)if("[object Object]"===Object.prototype.toString.call(b))for(var d in b)k+=d+":"+b[d]+"; ";else k=b+":"+c+";";"insertRule"in e?e.insertRule(a+"{"+k+"}",h):"addRule"in e&&e.addRule(a,k,h);return z(e.cssRules[h],
B)},n=function(a,b){var c=a.content,e=function(d,g,b){if(a.events[d])for(var f=0;f<a.events[d].length;f++)a.events[d][f].call(g,b)},n=function(d){return{singleSet:function(g,a,f,b){f||(f=0);0===f&&0<d.length&&(f=d.length-1);"[object Function]"===Object.prototype.toString.call(a)?(d[f].indexElem.style[g]=a(d[f].indexElem.style[g]),b||(d[f].updatablePropertys[g]=a)):(d[f].indexElem.style[g]=a,!b&&d[f].updatablePropertys[g]&&delete d[f].updatablePropertys[g]);return this},set:function(g,a){if(0<d.length)if(e(CSSC.eventBeforeChange,
g,a),e(CSSC.eventBeforeSet,g,a),"[object Object]"===Object.prototype.toString.call(g)&&0<Object.keys(g).length)for(var f=0;f<d.length;f++){for(var c in g)this.singleSet(c,g[c],f);d[f].updatableClass&&(d[f].updatableClass=!1)}else if("[object Function]"===Object.prototype.toString.call(g))for(var h,f=0;f<d.length;f++){h=g();for(c in h)this.singleSet(c,h[c],f,!0);d[f].updatableClass=g}else{if("[object String]"===Object.prototype.toString.call(g)&&"[object String]"===Object.prototype.toString.call(a))for(f=
0;f<d.length;f++)this.singleSet(g,a,f),d[f].updatableClass&&(d[f].updatableClass=!1)}else e(CSSC.eventBeforeCreate,g,a),p(b,g,a),d=t(b),e(CSSC.eventCreate,g,a);e(CSSC.eventChange,g,a);e(CSSC.eventSet,g,a);return this},get:function(g,a){for(var f="",b=0;b<d.length;b++)for(var c=0;c<d[b].indexElem.style.length;c++)if(d[b].indexElem.style[c]===g){f=d[b].indexElem.style[g];break}return f},"delete":function(g){e(CSSC.eventBeforeChange,g,null);e(CSSC.eventBeforeDelete,g,null);for(var a=0;a<d.length;a++)d[a].indexElem.style[g]=
"";e(CSSC.eventChange,g,null);e(CSSC.eventDelete,g,null);return this},destroy:function(){e(CSSC.eventBeforeDestroy,null,null);for(var a=0;a<d.length;a++)d[a].indexElem.parentStyleSheet.deleteRule(d[a]),h[b]&&delete h[b];e(CSSC.eventDestroy,null,null)},event:function(g,d){var b={type:function(){return g},call:d,index:null,destroy:function(){}};a.events[g]?a.events[g].push(b):a.events[g]=[b];b.index=function(){return a.events[g].length-1};return b},elems:d,pos:function(a){return 0<=a&&a<d.length?n([d[a]]):
null},first:function(){return this.pos(0)},last:function(){return this.pos(d.length-1)},type:a.type,merge:function(a){if(!d||0>=d.length)return this;var c;null===a&&(a=CSSC.conf.defaultMergeType);if(a===CSSC.mergeToFirst)c=d[0];else if(a===CSSC.mergeToLast)c=d[d.length-1];else if(a===CSSC.mergeToOwnFirst||a===CSSC.mergeToOwnLast){for(var f=0;f<d.length&&(elem[f].indexElem.parentStyleSheet.ownerNode.id!==m||(c=elem[f],a!==CSSC.mergeToOwnFirst));f++);c||(a=p(b),a.content[a.content.length-1].parentStyleSheet.ownerNode.id===
m&&(c=a.content[a.content.length-1]))}if(c){for(f=0;f<d.length;f++);d=[c]}return this},update:function(){for(var a,b=0;b<d.length;b++){if(d[b].updatableClass){a=d[b].updatableClass();for(var c in a)this.singleSet(c,a[c],b,!0)}for(c in d[b].updatablePropertys)this.singleSet(c,d[b].updatablePropertys[c],b,!1)}}}},k=function(a,b){return c[c.length-1](a,b)};k.elems=c;k.type=a.type;k.pos=function(a,b,e){if(0<=a&&a<c.length)return b?c[a].indexElem(b,e):c[a].indexElem};k.first=function(a,b){return this.pos(0,
a,b)};k.last=function(a,b){return this.pos(c.length-1,a,b)};k.update=function(){for(var a=0;a<c.length;a++)c[a].indexElem.update()};return a.type===CSSC.typeCondition?k:n(c)},b=function(a,l){if("string"===typeof a){var c=null;l||(c=t(a));null===c&&(c=p(a,null,null));return n(c,a)}b.imp(a)};b.append=function(a){w(a)};b.imp=function(a){var b,c,e;for(e in a)b=a[e],c=p(e,null,null),c=n(c,e),c.type!==CSSC.typeRule?c.last().imp(b):c.set(b)};b.exp=function(a){};b.animate=function(a,b){};b.keyframes=b.animate;
b.update=function(a){var b;if(a)b=n(t(a),a),b.update();else for(var c in h)b=n(h[c],a),b.update()};b.typeRule=0;b.typeCondition=1;b.typeKeyFrames=2;b.eventBeforeChange="beforechange";b.eventChange="change";b.eventBeforeSet="beforeset";b.eventSet="set";b.eventBeforeCreate="beforecreate";b.eventCreate="create";b.eventBeforeDelete="beforedelete";b.eventDelete="delete";b.eventBeforeDestroy="beforedestroy";b.eventDestroy="destroy";b.mergeToLast=0;b.mergeToFirst=1;b.mergeToOwnLast=2;b.mergeToOwnFirst=3;
b.conf={get:function(a){},set:function(a,b){},reset:function(a){},defaultMergeType:b.mergeToLast,dontTouchAllreadyLoadedCss:!1};b.conf._default=Object.assign({},b.conf);C?x():window.addEventListener("load",function(){});return b};return new A(document.styleSheets,null,!1,null)}();
